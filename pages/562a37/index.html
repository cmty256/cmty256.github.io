<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JVM基础入门 | 沉梦听雨的编程指南</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="https://cmty256.github.io/imgs-blog/logo/白云.38zbldnhh180.jpg">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3077305_pt8umhrn4k9.css">
    <script>
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "https://hm.baidu.com/hm.js?04a2517feeaf9f0d4d507cee97057d7c";
              var s = document.getElementsByTagName("script")[0]; 
              s.parentNode.insertBefore(hm, s);
            })();
          </script>
    <meta name="description" content="满招损，谦受益">
    <meta name="msvalidate.01" content="C6CD7D17F253A4A17B19D2EEBC95189E">
    <meta name="google-site-verification" content="1_X5AziuUEYcv2PowGXK9yiTwKre1owdUNTNB28UwQo">
    <meta name="keywords" content="编程分享, 开发, 程序员, Java, 计算机, IT, 八股">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.3543fb06.css" as="style"><link rel="preload" href="/assets/js/app.630ba73d.js" as="script"><link rel="preload" href="/assets/js/2.02bc9df6.js" as="script"><link rel="preload" href="/assets/js/30.ca1ed9ba.js" as="script"><link rel="preload" href="/assets/js/6.9155b086.js" as="script"><link rel="prefetch" href="/assets/js/10.ae6f45f2.js"><link rel="prefetch" href="/assets/js/100.46c61337.js"><link rel="prefetch" href="/assets/js/101.3dadcc21.js"><link rel="prefetch" href="/assets/js/102.6b9ae8e5.js"><link rel="prefetch" href="/assets/js/103.050deecb.js"><link rel="prefetch" href="/assets/js/104.36ad6ed3.js"><link rel="prefetch" href="/assets/js/105.72200513.js"><link rel="prefetch" href="/assets/js/106.4a5b9c9d.js"><link rel="prefetch" href="/assets/js/107.58a9cb6c.js"><link rel="prefetch" href="/assets/js/108.adf8e038.js"><link rel="prefetch" href="/assets/js/109.57e14f9e.js"><link rel="prefetch" href="/assets/js/11.1d2ab218.js"><link rel="prefetch" href="/assets/js/110.4216a0e3.js"><link rel="prefetch" href="/assets/js/111.f069effc.js"><link rel="prefetch" href="/assets/js/112.b461cce2.js"><link rel="prefetch" href="/assets/js/113.5d575def.js"><link rel="prefetch" href="/assets/js/114.5cb44cf8.js"><link rel="prefetch" href="/assets/js/115.eec9f043.js"><link rel="prefetch" href="/assets/js/116.997b169b.js"><link rel="prefetch" href="/assets/js/117.fe47586e.js"><link rel="prefetch" href="/assets/js/118.01d90b30.js"><link rel="prefetch" href="/assets/js/119.45bae86a.js"><link rel="prefetch" href="/assets/js/12.c67a55bb.js"><link rel="prefetch" href="/assets/js/120.2055a4c5.js"><link rel="prefetch" href="/assets/js/121.50c079e8.js"><link rel="prefetch" href="/assets/js/122.c635ba5f.js"><link rel="prefetch" href="/assets/js/123.601837d6.js"><link rel="prefetch" href="/assets/js/124.3ecf5ce1.js"><link rel="prefetch" href="/assets/js/125.a8ef511e.js"><link rel="prefetch" href="/assets/js/126.80da372b.js"><link rel="prefetch" href="/assets/js/127.645cdaaa.js"><link rel="prefetch" href="/assets/js/128.1679134d.js"><link rel="prefetch" href="/assets/js/129.9edbe9ae.js"><link rel="prefetch" href="/assets/js/13.f8ba0572.js"><link rel="prefetch" href="/assets/js/130.6de6cd75.js"><link rel="prefetch" href="/assets/js/131.8f49d111.js"><link rel="prefetch" href="/assets/js/132.56f24c74.js"><link rel="prefetch" href="/assets/js/133.ffa2058f.js"><link rel="prefetch" href="/assets/js/134.43f35845.js"><link rel="prefetch" href="/assets/js/135.e7d901c4.js"><link rel="prefetch" href="/assets/js/136.e1d43c33.js"><link rel="prefetch" href="/assets/js/137.9f4b03c9.js"><link rel="prefetch" href="/assets/js/138.bc627dfa.js"><link rel="prefetch" href="/assets/js/139.3fd5a967.js"><link rel="prefetch" href="/assets/js/14.d2a5b8c7.js"><link rel="prefetch" href="/assets/js/140.44a2eab4.js"><link rel="prefetch" href="/assets/js/141.2e995a51.js"><link rel="prefetch" href="/assets/js/142.ccf0802b.js"><link rel="prefetch" href="/assets/js/143.b871883e.js"><link rel="prefetch" href="/assets/js/144.a808eddc.js"><link rel="prefetch" href="/assets/js/145.9f5a49df.js"><link rel="prefetch" href="/assets/js/146.643aaea7.js"><link rel="prefetch" href="/assets/js/147.d20e25eb.js"><link rel="prefetch" href="/assets/js/148.ac1300e1.js"><link rel="prefetch" href="/assets/js/149.3a52837e.js"><link rel="prefetch" href="/assets/js/15.92909d62.js"><link rel="prefetch" href="/assets/js/150.0feff48c.js"><link rel="prefetch" href="/assets/js/151.9874a347.js"><link rel="prefetch" href="/assets/js/152.15d22b49.js"><link rel="prefetch" href="/assets/js/153.b08e97a6.js"><link rel="prefetch" href="/assets/js/154.08fdd0e9.js"><link rel="prefetch" href="/assets/js/155.fcc756d3.js"><link rel="prefetch" href="/assets/js/156.8677cb15.js"><link rel="prefetch" href="/assets/js/157.0e1c91ef.js"><link rel="prefetch" href="/assets/js/158.b8481abc.js"><link rel="prefetch" href="/assets/js/159.7268940e.js"><link rel="prefetch" href="/assets/js/16.da358268.js"><link rel="prefetch" href="/assets/js/160.2b23b1f8.js"><link rel="prefetch" href="/assets/js/161.f20ce893.js"><link rel="prefetch" href="/assets/js/162.712031a9.js"><link rel="prefetch" href="/assets/js/163.c1e3402d.js"><link rel="prefetch" href="/assets/js/164.ccfad889.js"><link rel="prefetch" href="/assets/js/165.371d3fe2.js"><link rel="prefetch" href="/assets/js/166.8d248034.js"><link rel="prefetch" href="/assets/js/167.dad02efd.js"><link rel="prefetch" href="/assets/js/168.922ac8d0.js"><link rel="prefetch" href="/assets/js/169.04ea32c1.js"><link rel="prefetch" href="/assets/js/17.3088d449.js"><link rel="prefetch" href="/assets/js/170.9439aef3.js"><link rel="prefetch" href="/assets/js/171.0040c6c8.js"><link rel="prefetch" href="/assets/js/172.7c623e46.js"><link rel="prefetch" href="/assets/js/173.96d1e6fb.js"><link rel="prefetch" href="/assets/js/174.c2018297.js"><link rel="prefetch" href="/assets/js/175.f056baab.js"><link rel="prefetch" href="/assets/js/176.707dbed2.js"><link rel="prefetch" href="/assets/js/177.42512186.js"><link rel="prefetch" href="/assets/js/178.6d905463.js"><link rel="prefetch" href="/assets/js/179.aebd245e.js"><link rel="prefetch" href="/assets/js/18.94411902.js"><link rel="prefetch" href="/assets/js/180.ac34cca6.js"><link rel="prefetch" href="/assets/js/181.71c48fe4.js"><link rel="prefetch" href="/assets/js/182.554192f0.js"><link rel="prefetch" href="/assets/js/183.40912912.js"><link rel="prefetch" href="/assets/js/184.9b306ca0.js"><link rel="prefetch" href="/assets/js/185.dc947a1e.js"><link rel="prefetch" href="/assets/js/186.53f2e812.js"><link rel="prefetch" href="/assets/js/187.7a336f3f.js"><link rel="prefetch" href="/assets/js/188.049f8a54.js"><link rel="prefetch" href="/assets/js/189.e628c11b.js"><link rel="prefetch" href="/assets/js/19.9af095a3.js"><link rel="prefetch" href="/assets/js/190.2e898cd5.js"><link rel="prefetch" href="/assets/js/191.c396c548.js"><link rel="prefetch" href="/assets/js/192.fb0821b2.js"><link rel="prefetch" href="/assets/js/193.92c5cf97.js"><link rel="prefetch" href="/assets/js/194.af1eb5c9.js"><link rel="prefetch" href="/assets/js/195.e9b054aa.js"><link rel="prefetch" href="/assets/js/196.2ce58f32.js"><link rel="prefetch" href="/assets/js/197.4a628283.js"><link rel="prefetch" href="/assets/js/198.482f200e.js"><link rel="prefetch" href="/assets/js/199.f02e6c8c.js"><link rel="prefetch" href="/assets/js/20.68d82b3e.js"><link rel="prefetch" href="/assets/js/200.7bf1f83f.js"><link rel="prefetch" href="/assets/js/201.1179e9f3.js"><link rel="prefetch" href="/assets/js/202.a598de98.js"><link rel="prefetch" href="/assets/js/203.b98ced39.js"><link rel="prefetch" href="/assets/js/204.2a143efd.js"><link rel="prefetch" href="/assets/js/205.702161d9.js"><link rel="prefetch" href="/assets/js/206.254cefa7.js"><link rel="prefetch" href="/assets/js/207.38c41382.js"><link rel="prefetch" href="/assets/js/208.fccac56f.js"><link rel="prefetch" href="/assets/js/209.0887982f.js"><link rel="prefetch" href="/assets/js/21.f0611f36.js"><link rel="prefetch" href="/assets/js/210.cdf22678.js"><link rel="prefetch" href="/assets/js/211.a4eb5183.js"><link rel="prefetch" href="/assets/js/212.eb581e60.js"><link rel="prefetch" href="/assets/js/213.94167fbf.js"><link rel="prefetch" href="/assets/js/214.b51c850f.js"><link rel="prefetch" href="/assets/js/215.e4177115.js"><link rel="prefetch" href="/assets/js/216.d6f7b7b1.js"><link rel="prefetch" href="/assets/js/217.4ac6608b.js"><link rel="prefetch" href="/assets/js/218.6c97ce11.js"><link rel="prefetch" href="/assets/js/219.ba707afb.js"><link rel="prefetch" href="/assets/js/22.16993069.js"><link rel="prefetch" href="/assets/js/220.003ca391.js"><link rel="prefetch" href="/assets/js/221.3151539c.js"><link rel="prefetch" href="/assets/js/222.f3f717ee.js"><link rel="prefetch" href="/assets/js/223.403c00f7.js"><link rel="prefetch" href="/assets/js/224.5616645d.js"><link rel="prefetch" href="/assets/js/225.fe7fffb6.js"><link rel="prefetch" href="/assets/js/226.f7bfa919.js"><link rel="prefetch" href="/assets/js/227.94a9c91e.js"><link rel="prefetch" href="/assets/js/228.465c3a87.js"><link rel="prefetch" href="/assets/js/229.d173de4a.js"><link rel="prefetch" href="/assets/js/23.85f1aeed.js"><link rel="prefetch" href="/assets/js/230.5857b6ca.js"><link rel="prefetch" href="/assets/js/231.0bbb21ab.js"><link rel="prefetch" href="/assets/js/232.c72607d0.js"><link rel="prefetch" href="/assets/js/233.94d00721.js"><link rel="prefetch" href="/assets/js/234.03e9bfd3.js"><link rel="prefetch" href="/assets/js/235.80c67ba2.js"><link rel="prefetch" href="/assets/js/236.bcf526d8.js"><link rel="prefetch" href="/assets/js/237.b571ab70.js"><link rel="prefetch" href="/assets/js/238.e529b606.js"><link rel="prefetch" href="/assets/js/239.b2366088.js"><link rel="prefetch" href="/assets/js/24.deb75536.js"><link rel="prefetch" href="/assets/js/240.6fc61263.js"><link rel="prefetch" href="/assets/js/241.8d71e900.js"><link rel="prefetch" href="/assets/js/242.bc138c5e.js"><link rel="prefetch" href="/assets/js/243.eea19321.js"><link rel="prefetch" href="/assets/js/244.d725a17b.js"><link rel="prefetch" href="/assets/js/245.547adb07.js"><link rel="prefetch" href="/assets/js/246.b87a8bbc.js"><link rel="prefetch" href="/assets/js/247.42305559.js"><link rel="prefetch" href="/assets/js/248.9f85c52d.js"><link rel="prefetch" href="/assets/js/249.8d4cc7b4.js"><link rel="prefetch" href="/assets/js/25.61e6112d.js"><link rel="prefetch" href="/assets/js/250.ec98b9c4.js"><link rel="prefetch" href="/assets/js/251.e68cd14e.js"><link rel="prefetch" href="/assets/js/252.46f56391.js"><link rel="prefetch" href="/assets/js/253.32d23540.js"><link rel="prefetch" href="/assets/js/254.169dd4aa.js"><link rel="prefetch" href="/assets/js/255.d769eaea.js"><link rel="prefetch" href="/assets/js/256.90c21b1c.js"><link rel="prefetch" href="/assets/js/257.ac5f0763.js"><link rel="prefetch" href="/assets/js/258.14115743.js"><link rel="prefetch" href="/assets/js/259.4fc2f21e.js"><link rel="prefetch" href="/assets/js/26.849367cb.js"><link rel="prefetch" href="/assets/js/260.f1ac64c2.js"><link rel="prefetch" href="/assets/js/261.1062017e.js"><link rel="prefetch" href="/assets/js/262.3ca14f35.js"><link rel="prefetch" href="/assets/js/263.8b8f7016.js"><link rel="prefetch" href="/assets/js/264.095775f0.js"><link rel="prefetch" href="/assets/js/265.25b88a6c.js"><link rel="prefetch" href="/assets/js/266.7c3bb303.js"><link rel="prefetch" href="/assets/js/267.626e0ba8.js"><link rel="prefetch" href="/assets/js/268.389fd8d6.js"><link rel="prefetch" href="/assets/js/269.baf13530.js"><link rel="prefetch" href="/assets/js/27.cbc981d5.js"><link rel="prefetch" href="/assets/js/270.0cbd55d2.js"><link rel="prefetch" href="/assets/js/271.52ad181b.js"><link rel="prefetch" href="/assets/js/272.184cf7bd.js"><link rel="prefetch" href="/assets/js/273.06215134.js"><link rel="prefetch" href="/assets/js/274.069b4a88.js"><link rel="prefetch" href="/assets/js/275.0a42f9d7.js"><link rel="prefetch" href="/assets/js/276.f9a15931.js"><link rel="prefetch" href="/assets/js/277.89ecb825.js"><link rel="prefetch" href="/assets/js/278.734f7527.js"><link rel="prefetch" href="/assets/js/279.32c6d59f.js"><link rel="prefetch" href="/assets/js/28.408fb889.js"><link rel="prefetch" href="/assets/js/280.83d71e12.js"><link rel="prefetch" href="/assets/js/281.89e6567e.js"><link rel="prefetch" href="/assets/js/282.82bc77bd.js"><link rel="prefetch" href="/assets/js/283.3deb63b8.js"><link rel="prefetch" href="/assets/js/284.d1c7bf48.js"><link rel="prefetch" href="/assets/js/285.721be986.js"><link rel="prefetch" href="/assets/js/286.5b7c7d3c.js"><link rel="prefetch" href="/assets/js/287.233b9143.js"><link rel="prefetch" href="/assets/js/288.9c7b0ab2.js"><link rel="prefetch" href="/assets/js/289.c376c026.js"><link rel="prefetch" href="/assets/js/29.7c8ee532.js"><link rel="prefetch" href="/assets/js/290.6c0185a2.js"><link rel="prefetch" href="/assets/js/291.3c1e9465.js"><link rel="prefetch" href="/assets/js/292.f737e693.js"><link rel="prefetch" href="/assets/js/3.931a19c0.js"><link rel="prefetch" href="/assets/js/31.a915666f.js"><link rel="prefetch" href="/assets/js/32.34547764.js"><link rel="prefetch" href="/assets/js/33.6cfa6c7a.js"><link rel="prefetch" href="/assets/js/34.b0069147.js"><link rel="prefetch" href="/assets/js/35.3f1c065f.js"><link rel="prefetch" href="/assets/js/36.61266fde.js"><link rel="prefetch" href="/assets/js/37.8b4fab24.js"><link rel="prefetch" href="/assets/js/38.63c689b4.js"><link rel="prefetch" href="/assets/js/39.f341f7e0.js"><link rel="prefetch" href="/assets/js/4.61011128.js"><link rel="prefetch" href="/assets/js/40.e7235f22.js"><link rel="prefetch" href="/assets/js/41.9448f1e0.js"><link rel="prefetch" href="/assets/js/42.ec5c3f26.js"><link rel="prefetch" href="/assets/js/43.14fa0c3e.js"><link rel="prefetch" href="/assets/js/44.fde28787.js"><link rel="prefetch" href="/assets/js/45.1650c7f5.js"><link rel="prefetch" href="/assets/js/46.d2e9ec2f.js"><link rel="prefetch" href="/assets/js/47.d63b4c12.js"><link rel="prefetch" href="/assets/js/48.9a963ec8.js"><link rel="prefetch" href="/assets/js/49.7c6279f5.js"><link rel="prefetch" href="/assets/js/5.f7dbece9.js"><link rel="prefetch" href="/assets/js/50.b1db079d.js"><link rel="prefetch" href="/assets/js/51.107b85e0.js"><link rel="prefetch" href="/assets/js/52.6efd3b93.js"><link rel="prefetch" href="/assets/js/53.73834fb2.js"><link rel="prefetch" href="/assets/js/54.3a1ad36b.js"><link rel="prefetch" href="/assets/js/55.e4c710e2.js"><link rel="prefetch" href="/assets/js/56.34b3e225.js"><link rel="prefetch" href="/assets/js/57.3d1bdd9f.js"><link rel="prefetch" href="/assets/js/58.24aee64d.js"><link rel="prefetch" href="/assets/js/59.f41a4d1d.js"><link rel="prefetch" href="/assets/js/60.d37426ed.js"><link rel="prefetch" href="/assets/js/61.ca8e718c.js"><link rel="prefetch" href="/assets/js/62.830a3edf.js"><link rel="prefetch" href="/assets/js/63.15f2f335.js"><link rel="prefetch" href="/assets/js/64.daff38c6.js"><link rel="prefetch" href="/assets/js/65.101d0aac.js"><link rel="prefetch" href="/assets/js/66.75219a81.js"><link rel="prefetch" href="/assets/js/67.4a85e2c4.js"><link rel="prefetch" href="/assets/js/68.aa1fa1eb.js"><link rel="prefetch" href="/assets/js/69.40f4c8c4.js"><link rel="prefetch" href="/assets/js/7.00d85485.js"><link rel="prefetch" href="/assets/js/70.1b5450b1.js"><link rel="prefetch" href="/assets/js/71.c0963c64.js"><link rel="prefetch" href="/assets/js/72.ac7590b5.js"><link rel="prefetch" href="/assets/js/73.a568e382.js"><link rel="prefetch" href="/assets/js/74.fde2e777.js"><link rel="prefetch" href="/assets/js/75.07455673.js"><link rel="prefetch" href="/assets/js/76.39e6b8d5.js"><link rel="prefetch" href="/assets/js/77.ab468b5e.js"><link rel="prefetch" href="/assets/js/78.7251650f.js"><link rel="prefetch" href="/assets/js/79.89e02a4d.js"><link rel="prefetch" href="/assets/js/8.70efc360.js"><link rel="prefetch" href="/assets/js/80.9268518e.js"><link rel="prefetch" href="/assets/js/81.83c1eae0.js"><link rel="prefetch" href="/assets/js/82.a58529d6.js"><link rel="prefetch" href="/assets/js/83.7d42238a.js"><link rel="prefetch" href="/assets/js/84.ed819b03.js"><link rel="prefetch" href="/assets/js/85.96f0038a.js"><link rel="prefetch" href="/assets/js/86.f7236beb.js"><link rel="prefetch" href="/assets/js/87.66a61908.js"><link rel="prefetch" href="/assets/js/88.ff1e59c2.js"><link rel="prefetch" href="/assets/js/89.9f54f169.js"><link rel="prefetch" href="/assets/js/9.cbbce9b9.js"><link rel="prefetch" href="/assets/js/90.fea4e72b.js"><link rel="prefetch" href="/assets/js/91.33075a43.js"><link rel="prefetch" href="/assets/js/92.485df598.js"><link rel="prefetch" href="/assets/js/93.b29cc9fd.js"><link rel="prefetch" href="/assets/js/94.569ff407.js"><link rel="prefetch" href="/assets/js/95.dd85a400.js"><link rel="prefetch" href="/assets/js/96.7425743a.js"><link rel="prefetch" href="/assets/js/97.fe4e7b57.js"><link rel="prefetch" href="/assets/js/98.23ccb710.js"><link rel="prefetch" href="/assets/js/99.4d27a90b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3543fb06.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://cmty256.github.io/imgs-blog/logo/白云.38zbldnhh180.jpg" alt="沉梦听雨的编程指南" class="logo"> <span class="site-name can-hide">沉梦听雨的编程指南</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/11aacc/" class="nav-link">基础篇</a></li><li class="dropdown-item"><!----> <a href="/pages/2e780e/" class="nav-link">集合篇</a></li><li class="dropdown-item"><!----> <a href="/pages/846d88/" class="nav-link">并发篇</a></li><li class="dropdown-item"><!----> <a href="/pages/562a37/" aria-current="page" class="nav-link router-link-exact-active router-link-active">JVM</a></li><li class="dropdown-item"><!----> <a href="/pages/a5d9a6/" class="nav-link">新特性</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><!----> <span class="title" style="display:;">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/7b1cb2/" class="nav-link">计算机网络</a></li><li class="dropdown-item"><!----> <a href="/pages/6048a8/" class="nav-link">操作系统</a></li><li class="dropdown-item"><!----> <a href="/pages/3b34ba/" class="nav-link">数据结构与算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/efa3f2/" class="nav-link">基础篇</a></li><li class="dropdown-item"><!----> <a href="/pages/ccc445/" class="nav-link">MySql</a></li><li class="dropdown-item"><!----> <a href="/pages/54616e/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/pages/980c9c/" class="nav-link">达梦数据库</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用框架" class="dropdown-title"><!----> <span class="title" style="display:;">常用框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/4969e6/" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/pages/72bcc7/" class="nav-link">SpringBoot</a></li><li class="dropdown-item"><!----> <a href="/pages/93b888/" class="nav-link">Mybatis</a></li><li class="dropdown-item"><!----> <a href="/pages/a54fbc/" class="nav-link">Shiro</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="系统设计" class="dropdown-title"><!----> <span class="title" style="display:;">系统设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/649916/" class="nav-link">设计须知</a></li><li class="dropdown-item"><!----> <a href="/pages/3fcc71/" class="nav-link">UML画图</a></li><li class="dropdown-item"><!----> <a href="/pages/793d0a/" class="nav-link">权限校验</a></li><li class="dropdown-item"><!----> <a href="/pages/6ea7eb/" class="nav-link">设计模式</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务" class="dropdown-title"><!----> <span class="title" style="display:;">微服务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/c6222f/" class="nav-link">API网关</a></li><li class="dropdown-item"><!----> <a href="/pages//" class="nav-link">RPC</a></li><li class="dropdown-item"><!----> <a href="/pages/2f66e5/" class="nav-link">消息队列</a></li><li class="dropdown-item"><!----> <a href="/pages/75e0cf/" class="nav-link">SpringCloud</a></li><li class="dropdown-item"><!----> <a href="/pages/957695/" class="nav-link">分布式事务</a></li><li class="dropdown-item"><!----> <a href="/pages/2beec7/" class="nav-link">云存储</a></li><li class="dropdown-item"><!----> <a href="/pages/9eed4b/" class="nav-link">搜索引擎</a></li><li class="dropdown-item"><!----> <a href="/pages/9f26dc/" class="nav-link">多媒体框架</a></li><li class="dropdown-item"><!----> <a href="/pages/412fe7/" class="nav-link">虚拟机</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发日常" class="dropdown-title"><!----> <span class="title" style="display:;">开发日常</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/626493/" class="nav-link">开发工具篇</a></li><li class="dropdown-item"><!----> <a href="/pages/bdbd1f/" class="nav-link">工具库篇</a></li><li class="dropdown-item"><!----> <a href="/pages/cc202d/" class="nav-link">开发技巧篇</a></li><li class="dropdown-item"><!----> <a href="/pages/dea09d/" class="nav-link">工具类系列</a></li><li class="dropdown-item"><!----> <a href="/pages/3cd6be/" class="nav-link">随笔</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端学习" class="dropdown-title"><!----> <span class="title" style="display:;">前端学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/3eeffb/" class="nav-link">前端环境搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/99897f/" class="nav-link">HTML与CSS</a></li><li class="dropdown-item"><!----> <a href="/pages/51542d/" class="nav-link">JS学习</a></li><li class="dropdown-item"><!----> <a href="/pages/803f9d/" class="nav-link">Vue3入门</a></li><li class="dropdown-item"><!----> <a href="/pages/ca4cfb/" class="nav-link">Vue3进阶</a></li><li class="dropdown-item"><!----> <a href="/pages/50e8d3/" class="nav-link">黑马Vue3</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目笔记" class="dropdown-title"><!----> <span class="title" style="display:;">项目笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/ebb9f9/" class="nav-link">脚手架搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/fbc2fc/" class="nav-link">瑞吉外卖</a></li><li class="dropdown-item"><!----> <a href="/pages/ee76ba/" class="nav-link">黑马点评</a></li><li class="dropdown-item"><!----> <a href="/pages/fa01b6/" class="nav-link">vue-blog</a></li><li class="dropdown-item"><!----> <a href="/pages/b363e2/" class="nav-link">沉梦接口开放平台</a></li><li class="dropdown-item"><!----> <a href="/pages/72b962/" class="nav-link">用户中心</a></li><li class="dropdown-item"><!----> <a href="/pages/8baa93/" class="nav-link">聚合搜索平台</a></li><li class="dropdown-item"><!----> <a href="/pages/a6b2f3/" class="nav-link">仿12306项目</a></li><li class="dropdown-item"><!----> <a href="/pages/b85237/" class="nav-link">壁纸小程序项目</a></li><li class="dropdown-item"><!----> <a href="/pages/a2c11e/" class="nav-link">RuoYi-Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它" class="dropdown-title"><!----> <span class="title" style="display:;">其它</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/fa256e/" class="nav-link">博客搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/335531/" class="nav-link">网站收藏箱</a></li><li class="dropdown-item"><!----> <a href="/pages/94109b/" class="nav-link">断墨寻径摘录</a></li><li class="dropdown-item"><!----> <a href="/pages/22f2c8/" class="nav-link">费曼学习法</a></li></ul></div></div> <a href="https://github.com/cmty256" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cmty256.github.io/picx-images-hosting/logo/0bd74b62680d5dc2d82d50efcac4546.8adfdu46qo.jpg"> <div class="blogger-info"><h3>沉梦听雨</h3> <span>时间是最好的浸渍剂，而沉淀是最好的提纯器🚀</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/11aacc/" class="nav-link">基础篇</a></li><li class="dropdown-item"><!----> <a href="/pages/2e780e/" class="nav-link">集合篇</a></li><li class="dropdown-item"><!----> <a href="/pages/846d88/" class="nav-link">并发篇</a></li><li class="dropdown-item"><!----> <a href="/pages/562a37/" aria-current="page" class="nav-link router-link-exact-active router-link-active">JVM</a></li><li class="dropdown-item"><!----> <a href="/pages/a5d9a6/" class="nav-link">新特性</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><!----> <span class="title" style="display:;">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/7b1cb2/" class="nav-link">计算机网络</a></li><li class="dropdown-item"><!----> <a href="/pages/6048a8/" class="nav-link">操作系统</a></li><li class="dropdown-item"><!----> <a href="/pages/3b34ba/" class="nav-link">数据结构与算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/efa3f2/" class="nav-link">基础篇</a></li><li class="dropdown-item"><!----> <a href="/pages/ccc445/" class="nav-link">MySql</a></li><li class="dropdown-item"><!----> <a href="/pages/54616e/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/pages/980c9c/" class="nav-link">达梦数据库</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用框架" class="dropdown-title"><!----> <span class="title" style="display:;">常用框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/4969e6/" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/pages/72bcc7/" class="nav-link">SpringBoot</a></li><li class="dropdown-item"><!----> <a href="/pages/93b888/" class="nav-link">Mybatis</a></li><li class="dropdown-item"><!----> <a href="/pages/a54fbc/" class="nav-link">Shiro</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="系统设计" class="dropdown-title"><!----> <span class="title" style="display:;">系统设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/649916/" class="nav-link">设计须知</a></li><li class="dropdown-item"><!----> <a href="/pages/3fcc71/" class="nav-link">UML画图</a></li><li class="dropdown-item"><!----> <a href="/pages/793d0a/" class="nav-link">权限校验</a></li><li class="dropdown-item"><!----> <a href="/pages/6ea7eb/" class="nav-link">设计模式</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务" class="dropdown-title"><!----> <span class="title" style="display:;">微服务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/c6222f/" class="nav-link">API网关</a></li><li class="dropdown-item"><!----> <a href="/pages//" class="nav-link">RPC</a></li><li class="dropdown-item"><!----> <a href="/pages/2f66e5/" class="nav-link">消息队列</a></li><li class="dropdown-item"><!----> <a href="/pages/75e0cf/" class="nav-link">SpringCloud</a></li><li class="dropdown-item"><!----> <a href="/pages/957695/" class="nav-link">分布式事务</a></li><li class="dropdown-item"><!----> <a href="/pages/2beec7/" class="nav-link">云存储</a></li><li class="dropdown-item"><!----> <a href="/pages/9eed4b/" class="nav-link">搜索引擎</a></li><li class="dropdown-item"><!----> <a href="/pages/9f26dc/" class="nav-link">多媒体框架</a></li><li class="dropdown-item"><!----> <a href="/pages/412fe7/" class="nav-link">虚拟机</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发日常" class="dropdown-title"><!----> <span class="title" style="display:;">开发日常</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/626493/" class="nav-link">开发工具篇</a></li><li class="dropdown-item"><!----> <a href="/pages/bdbd1f/" class="nav-link">工具库篇</a></li><li class="dropdown-item"><!----> <a href="/pages/cc202d/" class="nav-link">开发技巧篇</a></li><li class="dropdown-item"><!----> <a href="/pages/dea09d/" class="nav-link">工具类系列</a></li><li class="dropdown-item"><!----> <a href="/pages/3cd6be/" class="nav-link">随笔</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端学习" class="dropdown-title"><!----> <span class="title" style="display:;">前端学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/3eeffb/" class="nav-link">前端环境搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/99897f/" class="nav-link">HTML与CSS</a></li><li class="dropdown-item"><!----> <a href="/pages/51542d/" class="nav-link">JS学习</a></li><li class="dropdown-item"><!----> <a href="/pages/803f9d/" class="nav-link">Vue3入门</a></li><li class="dropdown-item"><!----> <a href="/pages/ca4cfb/" class="nav-link">Vue3进阶</a></li><li class="dropdown-item"><!----> <a href="/pages/50e8d3/" class="nav-link">黑马Vue3</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目笔记" class="dropdown-title"><!----> <span class="title" style="display:;">项目笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/ebb9f9/" class="nav-link">脚手架搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/fbc2fc/" class="nav-link">瑞吉外卖</a></li><li class="dropdown-item"><!----> <a href="/pages/ee76ba/" class="nav-link">黑马点评</a></li><li class="dropdown-item"><!----> <a href="/pages/fa01b6/" class="nav-link">vue-blog</a></li><li class="dropdown-item"><!----> <a href="/pages/b363e2/" class="nav-link">沉梦接口开放平台</a></li><li class="dropdown-item"><!----> <a href="/pages/72b962/" class="nav-link">用户中心</a></li><li class="dropdown-item"><!----> <a href="/pages/8baa93/" class="nav-link">聚合搜索平台</a></li><li class="dropdown-item"><!----> <a href="/pages/a6b2f3/" class="nav-link">仿12306项目</a></li><li class="dropdown-item"><!----> <a href="/pages/b85237/" class="nav-link">壁纸小程序项目</a></li><li class="dropdown-item"><!----> <a href="/pages/a2c11e/" class="nav-link">RuoYi-Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它" class="dropdown-title"><!----> <span class="title" style="display:;">其它</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/fa256e/" class="nav-link">博客搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/335531/" class="nav-link">网站收藏箱</a></li><li class="dropdown-item"><!----> <a href="/pages/94109b/" class="nav-link">断墨寻径摘录</a></li><li class="dropdown-item"><!----> <a href="/pages/22f2c8/" class="nav-link">费曼学习法</a></li></ul></div></div> <a href="https://github.com/cmty256" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>集合篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>并发篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JVM</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/562a37/" aria-current="page" class="active sidebar-link">JVM基础入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/562a37/#jvm-基础" class="sidebar-link">JVM 基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/562a37/#聊一聊-java-从编码到执行到底是一个怎么样的过程" class="sidebar-link">聊一聊 Java 从编码到执行到底是一个怎么样的过程？</a></li><li class="sidebar-sub-header level3"><a href="/pages/562a37/#什么是-jvm" class="sidebar-link">什么是 JVM?</a></li><li class="sidebar-sub-header level3"><a href="/pages/562a37/#常见的-jvm-实现" class="sidebar-link">常见的 JVM 实现</a></li><li class="sidebar-sub-header level3"><a href="/pages/562a37/#jdk-jre-jvm-的关系" class="sidebar-link">JDK JRE JVM 的关系</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/562a37/#class-文件格式" class="sidebar-link">Class 文件格式</a></li><li class="sidebar-sub-header level2"><a href="/pages/562a37/#类加载-初始化" class="sidebar-link">类加载 - 初始化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/562a37/#加载过程" class="sidebar-link">加载过程</a></li><li class="sidebar-sub-header level3"><a href="/pages/562a37/#类加载器" class="sidebar-link">类加载器</a></li><li class="sidebar-sub-header level3"><a href="/pages/562a37/#双亲委派" class="sidebar-link">双亲委派</a></li><li class="sidebar-sub-header level4"><a href="/pages/562a37/#为什么类加载器要使用双亲委派-重要" class="sidebar-link">为什么类加载器要使用双亲委派？（重要）</a></li><li class="sidebar-sub-header level3"><a href="/pages/562a37/#类加载器范围" class="sidebar-link">类加载器范围</a></li><li class="sidebar-sub-header level3"><a href="/pages/562a37/#自定义类加载器" class="sidebar-link">自定义类加载器</a></li><li class="sidebar-sub-header level4"><a href="/pages/562a37/#loadclass-源码解析" class="sidebar-link">loadClass 源码解析</a></li><li class="sidebar-sub-header level4"><a href="/pages/562a37/#自定义一个类加载器需要做什么" class="sidebar-link">自定义一个类加载器需要做什么？</a></li><li class="sidebar-sub-header level4"><a href="/pages/562a37/#加密" class="sidebar-link">加密</a></li><li class="sidebar-sub-header level3"><a href="/pages/562a37/#编译器" class="sidebar-link">编译器</a></li><li class="sidebar-sub-header level3"><a href="/pages/562a37/#懒加载" class="sidebar-link">懒加载</a></li><li class="sidebar-sub-header level3"><a href="/pages/562a37/#拓展知识" class="sidebar-link">拓展知识</a></li><li class="sidebar-sub-header level4"><a href="/pages/562a37/#双亲委派如何打破" class="sidebar-link">双亲委派如何打破？</a></li><li class="sidebar-sub-header level4"><a href="/pages/562a37/#类加载器涉及到了哪些设计模式" class="sidebar-link">类加载器涉及到了哪些设计模式？</a></li></ul></li></ul></li><li><a href="/pages/ff3623/" class="sidebar-link">JVM常问</a></li><li><a href="/pages/b57a05/" class="sidebar-link">jstat的应用</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>新特性</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java核心技术卷I</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>Java</span></li><li data-v-06225672><span data-v-06225672>JVM</span></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/cmty256" target="_blank" title="作者" class="beLink" data-v-06225672>沉梦听雨</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-08-11</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">JVM基础入门<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="jvm-基础入门"><a href="#jvm-基础入门" class="header-anchor">#</a> JVM 基础入门</h1> <h2 id="jvm-基础"><a href="#jvm-基础" class="header-anchor">#</a> JVM 基础</h2> <h3 id="聊一聊-java-从编码到执行到底是一个怎么样的过程"><a href="#聊一聊-java-从编码到执行到底是一个怎么样的过程" class="header-anchor">#</a> 聊一聊 Java 从编码到执行到底是一个怎么样的过程？</h3> <p><img alt="image-20230811223459658" data-src="https://cmty256.github.io/imgs-blog/Java/image-20230811223459658.ku0m0cn1b0g.png" loading="lazy" class="lazy"></p> <p>假设我们有一个文件 <code>x.Java</code>，你执行 <code>javac</code>，它就会变成 <code>x.class</code>。</p> <p><em>这个 class 怎么执行的？</em></p> <p>当我们调用 Java 命令的时候，class 会被 load 到内存，这块叫【Classloader】，会被 Classloader 装载到内存里。</p> <p>一般的情况下，我们写自己的类文件的时候也会用到 【Java 的类库】，所以他会把 Java 类库相关的这些个类也要装载到内存里，装载完成之后会调用【字节码解释器】或者是【JIT 即时编译器】来进行解释或编译，编译完之后由【执行引擎】开始执行，这以及下面面对的，那就是操作系统和硬件了。</p> <p>Java 编译好了之后变成 class， class 会被 load 到内存，与此同时像什么 string， object 这些个 class 也都会被 load 到内存。</p> <p><em>Java 是这个解释执行的还是编译执行的？</em></p> <p>其实解释和编译是可以混合的，特别常用的一些代码，代码用到的次数特别多，这个时候他会把代码做成一个及时的编译，做成一个本地的编译。</p> <p>你可以理解为就像 c 语言在 Windows 上执行的时候，把它编译成 exe 一样，那么下次再执行这段代码的时候，就不需要通过解释器来一句一句解释来执行了，执行引擎可以直接交给操作系统去让它调用，这个效率要高很多，不是所有的代码都要都会被 GIT 进行及时编译的，如果是这样的话，那整个 Java 就完全变成了不能跨平台了。</p> <p>所以有一些特定的，执行起来执行次数好多好多，用的特别多的时候，这个时候会进行一个即时编译器的编译。</p> <h3 id="什么是-jvm"><a href="#什么是-jvm" class="header-anchor">#</a> 什么是 JVM?</h3> <p>所谓的 JVM 虚拟机，其实它本身是一个规范，是虚构出来的一台计算机。拥有自己的操作系统，是一个跨语言平台。</p> <p><em>为什么 JVM 虚拟机能够支持多种语言运行在上面呢？</em></p> <p>最关键的原因是就是因为 class 这个东西，我们可以说任何的语言，只要你能编译成 class，符合 class 文件的规范，你就可以扔在 Java 虚拟机上去执行。</p> <p><strong>注意：JVM 只和 class 文件有关，与 java 无关。</strong></p> <p>JDK 官网：<a href="https://docs.oracle.com/javase/specs/" target="_blank" rel="noopener noreferrer">Java SE Specifications (oracle.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>维基百科：<a href="https://zh.wikipedia.org/wiki/Java%E8%99%9A%E6%8B%9F%E6%9C%BA" target="_blank" rel="noopener noreferrer">Java虚拟机 - 维基百科，自由的百科全书 (wikipedia.org)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>甲骨文中国：<a href="https://www.oracle.com/cn/java/" target="_blank" rel="noopener noreferrer">Java 软件 | Oracle 中国<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="常见的-jvm-实现"><a href="#常见的-jvm-实现" class="header-anchor">#</a> 常见的 JVM 实现</h3> <ol><li><p>Hotspot（最常用）</p> <ul><li>oracle 官方，我们做实验用的 JVM，Java 虚拟机</li> <li><code>java -version</code> 命令可查看使用的是什么 JVM</li> <li><strong>Hotspot 8 之后要收费，但 Open JDK 是开源的版本，免费</strong></li></ul></li> <li><p>Jrockit</p> <ul><li>BEA 曾经号称世界上最快的 JVM</li> <li>被 Oracle 收购，合并于 hotspot</li></ul></li> <li><p>TaobaoVM（免费）</p> <ul><li>hotspot 深度定制版</li></ul></li> <li><p>LiquidVM</p> <ul><li>直接针对硬件</li></ul></li> <li><p>azul zing（特别贵）</p> <ul><li>最新垃圾回收的业界标杆（号称 1ms 以内）</li> <li>www.azul.com</li></ul></li> <li><p>J9-IBM</p> <ul><li>Microsoft VM</li></ul></li></ol> <h3 id="jdk-jre-jvm-的关系"><a href="#jdk-jre-jvm-的关系" class="header-anchor">#</a> JDK JRE JVM 的关系</h3> <p>包含关系。</p> <p>JVM -- 运行 java 字节码的虚拟机</p> <p>JRE -- java 运行环境 == jvm + core（核心类库）</p> <p>JDK -- java 开发工具包 == jre + development kit（开发工具）</p> <h2 id="class-文件格式"><a href="#class-文件格式" class="header-anchor">#</a> Class 文件格式</h2> <p>Class 文件格式（<em>File Format</em>）</p> <ul><li>二进制字节流（由 java 虚拟机解释）</li> <li>数据类型: u1 u2 u4 u8 和 _info (表类型)
<ul><li>info 的来源是 hotspot 源码中的写法</li></ul></li> <li>查看 16 进制格式的 ClassFile
<ul><li>软件 - sublime / notepad /</li> <li>IDEA 插件 - BinEd</li></ul></li> <li>有很多可以更好观察 ByteCode 的方法
<ul><li>终端命令：<code>javap &lt;class文件路径&gt;</code>，<code>-v</code> 参数详细查看</li> <li>JBE 可以直接修改</li> <li>JClassLib - IDEA 插件之一</li></ul></li> <li>文件结构
<ul><li><strong>General Information（通用信息）：</strong> 这个部分包含了一些通用的信息，比如文件的魔数（magic number），文件版本号等。</li> <li><strong>Constant Pool（常量池）：</strong> 常量池是一个重要的数据结构，它存储了一系列常量，包括字面值、符号引用、类和接口的名称等。常量池在字节码文件中起到了存储和管理常量数据的作用。</li> <li><strong>Interfaces（接口）：</strong> 这部分定义了该类实现的接口。</li> <li><strong>Fields（字段）：</strong> 这部分描述了类的字段（成员变量），包括字段的名称、类型以及修饰符等信息。</li> <li><strong>Methods（方法）：</strong> 这部分描述了类的方法，包括方法的名称、参数列表、返回类型、字节码指令等。</li> <li><strong>Attributes（属性）：</strong> 属性提供了关于类、字段或方法的其他信息，例如源代码行号、注解等。这个部分可以包含多个不同类型的属性，每个属性都有一个名称和相应的数据。</li></ul></li></ul> <p>如下图示：</p> <p><img alt="image" data-src="https://cmty256.github.io/imgs-blog/Java/image.35tlgo72z6o0.png" loading="lazy" class="lazy"></p> <ul><li><strong>magic</strong>：魔数，是一个固定的字节序列，用于标识 Java 字节码文件。它的值为 0xCAFEBABE，用于确定文件是否是有效的 Java 字节码文件。</li> <li><strong>minor version</strong>：次版本号，指示 Java 编译器版本的次要更新。用于描述字节码文件与Java虚拟机版本的兼容性。</li> <li><strong>major version</strong>：主版本号，指示 Java 编译器版本的主要更新。同样用于描述字节码文件与 Java 虚拟机版本的兼容性。</li> <li><strong>constant_pool_count</strong>：常量池计数，表示常量池中常量的数量。十六进制 0010 转化为十进制为 16。常量池真正存储内容的时候存了 16 -1 项。后面的内容都是引用它。</li> <li><strong>#1:</strong>：常量池项，通常以 # 开头，表示一个常量池中的单个项。</li> <li><strong>access flags</strong>：访问标志，描述类或接口的访问级别和特性。</li> <li><strong>this_class</strong>：当前类的索引，指示当前类在常量池中的位置。</li> <li><strong>super class</strong>：父类的索引，指示父类在常量池中的位置。</li> <li><strong>interface_count</strong>：接口数量，表示该类实现的接口数量。</li> <li><strong>interfaces</strong>：接口列表，描述该类实现的接口在常量池中的位置。</li> <li><strong>fields_count</strong>：字段数量，表示该类中声明的字段数量。</li> <li><strong>methods_count</strong>：方法数量，表示该类中声明的方法数量。</li> <li><strong>method_info</strong>：方法信息，描述方法的访问标志、方法名、参数列表等。</li> <li><strong>attribute_count</strong>：属性数量，表示该类的属性数量。</li></ul> <p>每个部分描述了 Java 字节码文件的不同方面，从类的声明到方法的定义，以及与常量池等相关的信息。这些信息在 Java 虚拟机中被解析和使用，以正确地加载和执行 Java 类。</p> <blockquote><p>Java 的汇编指令有 200 多条。</p> <p>好文分享：<a href="https://zhuanlan.zhihu.com/p/149876413" target="_blank" rel="noopener noreferrer">class类文件结构<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="类加载-初始化"><a href="#类加载-初始化" class="header-anchor">#</a> 类加载 - 初始化</h2> <h3 id="加载过程"><a href="#加载过程" class="header-anchor">#</a> 加载过程</h3> <p>加载、链接和初始化是 Java 程序运行时的三个主要阶段。</p> <ol><li><p>Loading -- 加载</p></li> <li><p>Linking -- 链接</p> <ul><li>Verification -- 验证</li> <li>Preparation -- 准备</li> <li>Resolution -- 解析</li></ul></li> <li><p>Initializing -- 初始化</p></li></ol> <p>具体来说：</p> <ol><li><p><strong>Loading（加载）</strong>： 这是类加载过程的第一个阶段。在这个阶段，Java 虚拟机（JVM）会从类的外部源加载类的二进制数据，通常是从<em>磁盘</em>文件中加载，但也可以是网络、内存等。</p> <p>加载器将类的二进制数据（class文件）从外部源加载到<em>内存</em>中，并将其放置在运行时数据区的方法区内。</p></li> <li><p><strong>Linking（链接）</strong>： 这是加载过程的第二个阶段，它将类的二进制数据链接到 JVM 的运行时状态。</p> <p>链接过程分为以下三个步骤：</p> <ul><li><strong>Verification（验证）</strong>：确保类的二进制数据符合 JVM 规范，不违反类加载的安全性要求。这个步骤确保类的结构正确，不会引发运行时错误。</li> <li><strong>Preparation（准备）</strong>：为类的静态变量分配内存空间，并设置默认的初始值（通常为零值）。这个步骤为类变量分配内存并初始化，但不会为实例变量分配内存。（把 class 文件的静态变量赋默认值，比如 int 类型的默认值为 0）</li> <li><strong>Resolution（解析）</strong>：将（class文件里面的常量池里面用到的）符号引用转换为直接引用，解析动作可以在运行时再完成，也可以在编译时静态完成。这个步骤处理类、接口、方法和字段的符号引用，将其解析为实际的引用。</li></ul></li> <li><p><strong>Initializing（初始化）</strong>： 这是链接过程的最后一个阶段，也是类加载的最终阶段。在这个阶段，类的静态初始化器会被执行，初始化静态字段和执行静态块。这个阶段是在类被首次使用时触发的，例如创建类的实例、访问类的静态字段等。（调用类初始化代码 <code>&lt;clinit&gt;</code>，给静态成员变量赋初始值）</p></li></ol> <p>总结来说，类加载过程涉及到从外部源加载类的二进制数据，然后将其链接到 JVM 的运行时状态，最终进行初始化。链接阶段包括验证、准备和解析，而初始化阶段则会执行类的静态初始化器。这个过程确保类在 Java 虚拟机中正确加载和使用。</p> <p><em>加载之后会发生什么？</em></p> <p>任何一个 class 被加载到内存之后，会生成了两块内容。</p> <ul><li>第一块内容是这个二进制的，这块东西确实被落到内存，放到了内存的一块区域，可以原封不动的扔进去。</li> <li>第二个，它生成了一个 class 类的对象，通过以后其他的那些我们自己写的对象去访问这个对象，通过这个对象去访问 class 类的文件，所以生成一个 class 的对象，这个 class 对象是指向了这块内容。</li></ul> <p>在 Java 虚拟机中，类的元数据，包括类的结构信息、字段、方法、父类、接口等，都会被加载到方法区（元空间<em>Metaspace</em>，替代了永久代<em>PermGen</em>）中。Class 对象本身也是类的元数据之一，因此 Class 对象也存放在方法区中。 Class 对象在内存中的位置可以看作是类的描述符，用来操作该类的字节码以及其他相关的元数据。</p> <p>可以看看下面这两篇文章：</p> <ul><li><a href="https://blog.wangqi.love/articles/Java/%E6%96%B9%E6%B3%95%E5%8C%BA%E4%B8%8EMetaspace.html" target="_blank" rel="noopener noreferrer">方法区与Metaspace<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.zhihu.com/question/40543936" target="_blank" rel="noopener noreferrer">Java8取消permgen，使用mataspace有什么好处，内存结构有什么本质的变化？<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="类加载器"><a href="#类加载器" class="header-anchor">#</a> 类加载器</h3> <p>JVM 它本身有一个类加载器的层次，这个类加载器就是一个普通的 class，JVM 有一个类加载器的层次，分别来加载不同的 class。或者说，JVM 里面所有的 class 都是被类加载器给加载到内存的，那么这个类加载器简单说我们可以把它叫做 ClassLoader。</p> <p><img alt="image" data-src="https://cmty256.github.io/imgs-blog/Java/image.7dxh3fbo1is0.webp" loading="lazy" class="lazy"></p> <p><strong>注意：从下往上，是委托给父加载器，不是继承关系，是语法上的一种关系。</strong></p> <p>在 Java 虚拟机中，类加载器按照层次结构进行组织，分为三个主要层次：启动类加载器（Bootstrap ClassLoader）、扩展类加载器（Extension ClassLoader）和应用程序类加载器（Application ClassLoader，也称为系统类加载器）。这些类加载器形成了类加载器的双亲委派模型。</p> <ol><li><strong>启动类加载器（Bootstrap ClassLoader）</strong>：这是 Java 虚拟机的一部分，用于加载 Java 核心库（例如 <code>java.lang</code> 包中的类）。它是所有其他类加载器的父加载器，但它本身不是一个普通的 Java 类，因此在源码中并没有对应的类。它位于虚拟机内部，通常用本地代码实现。它是最顶层的类加载器，负责加载 Java 核心类库。</li> <li><strong>扩展类加载器（Extension ClassLoader）</strong>： 扩展类加载器用于加载 Java 虚拟机的扩展类库，位于 <code>jre/lib/ext</code> 目录中的类。它的父加载器是启动类加载器。</li> <li><strong>应用程序类加载器（Application ClassLoader）</strong>：这个加载器也称为系统类加载器，它负责加载应用程序的类，包括用户自定义的类和第三方库中的类。它的父加载器是扩展类加载器。</li></ol> <p>启动类加载器、扩展类加载器和应用程序类加载器构成了类加载器的层次结构，通过双亲委派模型来保证类的加载的一致性和安全性。在加载一个类时，首先会尝试由父加载器加载，只有在父加载器无法加载时，子加载器才会尝试加载。这个模型可以防止类的重复加载，同时保证了类的隔离性。</p> <p>在启动类加载器加载的类中，有一部分是虚拟机内部的类，比如 <code>java.lang.Object</code>、<code>java.lang.String</code> 等。这些类并不是普通的 Java 类，因此没有对应的源码。而在 Java 虚拟机的源码中，通常会对这些类的加载过程进行描述，但实际上它们是由虚拟机的实现提供的。</p> <p>最顶层加载器 Bootstrap 会返回一个空值。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">T004_ParentAndChild</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">T004_ParentAndChild</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">T004_ParentAndChild</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// App</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">T004_ParentAndChild</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Extension</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">T004_ParentAndChild</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Bootstrap，返回 null</span>
        <span class="token comment">// System.out.println(T004_ParentAndChild.class.getClassLoader().getParent().getParent().getParent()); // 解开注释就会报空指针异常</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>输出结果：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>sun.misc.Launcher$AppClassLoader@18b4aac2
null
sun.misc.Launcher$ExtClassLoader@4554617c
null
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="双亲委派"><a href="#双亲委派" class="header-anchor">#</a> 双亲委派</h3> <ol><li>父加载器
<ul><li>父加载器不是【类加载器的加载器】！！！也不是【类加载器的父类加载器】</li></ul></li> <li>双亲委派是一个孩子向父亲方向，然后父亲向孩子方向的双亲委派过程</li> <li>思考：为什么要搞双亲委派？
<ul><li>java.lang.String 类由自定义类加载器加载行不行？ -- 不行，因为不安全</li></ul></li></ol> <p>先是自底向上检查是否已经加载，然后再回过头来找 class 并加载，查看是否加载成功，一直到底都没加载成功就会抛出一个 class 找不到异常。</p> <p><img alt="image-20230819014050253" data-src="https://cmty256.github.io/imgs-blog/Java/image-20230819014050253.6pstpqtl5m40.webp" loading="lazy" class="lazy"></p> <p><em>这个缓存是在哪缓存？</em></p> <p>可以简单的认为是它自己内部维护的一个容器，一个 list 或者一个数组加载的东西都扔在里面。每个加载器都有自己的缓存。</p> <h4 id="为什么类加载器要使用双亲委派-重要"><a href="#为什么类加载器要使用双亲委派-重要" class="header-anchor">#</a> 为什么类加载器要使用双亲委派？（重要）</h4> <p>主要是为了安全。次要原因是资源浪费问题，避免重新加载问题（防止类重复加载）。</p> <h3 id="类加载器范围"><a href="#类加载器范围" class="header-anchor">#</a> 类加载器范围</h3> <p>来自 Launcher 源码</p> <ol><li>启动类加载器 <strong>Bootstrap ClassLoader</strong>：
<ul><li>加载路径：<code>sun.boot.class.path</code></li> <li>范围：它负责加载 Java 核心类库，这些类库包括 Java API 中的基础类，如 <code>java.lang</code> 包下的类等。</li> <li>作用：它是 Java 类加载器中最顶层的类加载器，负责加载虚拟机自身需要的类，以及在运行期间会被系统使用的类。由于 Bootstrap ClassLoader 是用本地代码来实现的，所以在 Java 中无法直接获取到该类加载器的引用。</li></ul></li> <li>扩展类加载器 <strong>ExtensionClassLoader</strong>：
<ul><li>加载路径：<code>java.ext.dirs</code></li> <li>范围：它负责加载 Java 的扩展库，这些库位于 JRE 的 <code>lib/ext</code> 目录或者由系统变量 <code>java.ext.dirs</code> 指定的路径。</li> <li>作用：它负责加载一些 Java 标准扩展库以及一些自定义的扩展库，这些库通常是一些可选的功能。扩展类加载器是由 <code>sun.misc.Launcher$ExtClassLoader</code> 实现的。</li></ul></li> <li>系统类加载器 <strong>AppClassLoader</strong>：
<ul><li>加载路径：<code>java.class.path</code></li> <li>范围：也被称为系统类加载器，它负责加载用户类路径（Classpath）上指定的类。</li> <li>作用：它负责加载应用程序中的类，包括开发者自己编写的类以及引用的第三方类库。应用类加载器是由 <code>sun.misc.Launcher$AppClassLoader</code> 实现的。</li></ul></li></ol> <p>代码查看：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">T003_ClassLoaderScope</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;根目录下加载&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> pathBoot <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;sun.boot.class.path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>pathBoot<span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">&quot;;&quot;</span><span class="token punctuation">,</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">lineSeparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;--------------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ext 下加载&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> pathExt <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;java.ext.dirs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>pathExt<span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">&quot;;&quot;</span><span class="token punctuation">,</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">lineSeparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;--------------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;App 下加载&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> pathApp <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;java.class.path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>pathApp<span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">&quot;;&quot;</span><span class="token punctuation">,</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">lineSeparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>输出结果：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>根目录下加载
C:\Program Files\Java\jdk1.8.0_321\jre\lib\resources.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\rt.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\sunrsasign.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\jsse.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\jce.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\charsets.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\jfr.jar
C:\Program Files\Java\jdk1.8.0_321\jre\classes
--------------------
ext 下加载
C:\Program Files\Java\jdk1.8.0_321\jre\lib\ext
C:\WINDOWS\Sun\Java\lib\ext
--------------------
App 下加载
C:\Program Files\Java\jdk1.8.0_321\jre\lib\charsets.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\deploy.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\ext\access-bridge-64.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\ext\cldrdata.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\ext\dnsns.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\ext\jaccess.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\ext\jfxrt.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\ext\localedata.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\ext\nashorn.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\ext\sunec.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\ext\sunjce_provider.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\ext\sunmscapi.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\ext\sunpkcs11.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\ext\zipfs.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\javaws.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\jce.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\jfr.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\jfxswt.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\jsse.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\management-agent.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\plugin.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\resources.jar
C:\Program Files\Java\jdk1.8.0_321\jre\lib\rt.jar
D:\笔记\学习资料\马士兵\JVM视频源码\out\production\JVM				// 项目路径
D:\software\idea2022\IntelliJ IDEA 2022.1.3\lib\idea_rt.jar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h3 id="自定义类加载器"><a href="#自定义类加载器" class="header-anchor">#</a> 自定义类加载器</h3> <p>当你想加载某个类的时候，可以调用 <code>loadClass</code> 方法</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">T005_LoadClassByHand</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Class</span> clazz <span class="token operator">=</span> <span class="token class-name">T005_LoadClassByHand</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">&quot;com.mashibing.jvm.c2_classloader.T002_ClassLoaderLevel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>clazz<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//利用类加载器加载资源，参考坦克图片的加载</span>
        <span class="token comment">//T005_LoadClassByHand.class.getClassLoader().getResourceAsStream(&quot;&quot;);</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="loadclass-源码解析"><a href="#loadclass-源码解析" class="header-anchor">#</a> loadClass 源码解析</h4> <p><code>loadClass</code> 方法是在双亲委派模型下实现的。</p> <p>findInCache -&gt; parent.loadClass -&gt; findClass()</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ClassLoader</span> parent<span class="token punctuation">;</span> <span class="token comment">// final 关键字修饰</span>

<span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">boolean</span> resolve<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token function">getClassLoadingLock</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 首先，检查类是否已经加载</span>
            <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> c <span class="token operator">=</span> <span class="token function">findLoadedClass</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">long</span> t0 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 如果类不在已加载类中，则委派给父类加载器加载</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        c <span class="token operator">=</span> parent<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        <span class="token comment">// 如果没有父加载器，则使用系统类加载器加载</span>
                        c <span class="token operator">=</span> <span class="token function">findBootstrapClassOrNull</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 如果找不到类，抛出ClassNotFoundException</span>
                    <span class="token comment">// 从非空父类装入器</span>
                <span class="token punctuation">}</span>
              
							 <span class="token comment">// 如果父加载器也找不到，则尝试自己加载</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 如果仍未找到，则按顺序调用 findClass</span>
                    <span class="token comment">// to find the class. 要找到这个类</span>
                    <span class="token keyword">long</span> t1 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    c <span class="token operator">=</span> <span class="token function">findClass</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// 这是定义类装入器；记录统计数据</span>
                    <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>PerfCounter</span><span class="token punctuation">.</span><span class="token function">getParentDelegationTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTime</span><span class="token punctuation">(</span>t1 <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>PerfCounter</span><span class="token punctuation">.</span><span class="token function">getFindClassTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addElapsedTimeFrom</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>PerfCounter</span><span class="token punctuation">.</span><span class="token function">getFindClasses</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>resolve<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">resolveClass</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> c<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">findClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">{</span> <span class="token comment">// findClass被protected修饰，保护起来</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p>主要步骤如下：</p> <ol><li>首先，方法会尝试从已加载的类中查找目标类是否已经加载，如果已经加载，则直接返回该类。</li> <li>如果目标类未加载，它会尝试委派给父类加载器来加载。这是双亲委派模型的核心思想之一。父类加载器会重复这个过程，直到到达启动类加载器（Bootstrap ClassLoader）为止。</li> <li>如果父类加载器也无法加载目标类，则 <code>loadClass</code> 方法会调用 <code>findClass</code> 方法，尝试自己加载目标类。这是子类加载器在加载自己类的<strong>最后一步</strong>。</li> <li>最后，如果 <code>resolve</code> 参数为 <code>true</code>，则会调用 <code>resolveClass</code> 方法，用于解析加载的类，确保类的完整性和正确性。</li></ol> <p><em>什么时候需要自己去加载？</em></p> <p><em>加载进去就生成 class 对象吗？</em></p> <p>不是，要经过 初始化 才生成 class 对象。</p> <h4 id="自定义一个类加载器需要做什么"><a href="#自定义一个类加载器需要做什么" class="header-anchor">#</a> 自定义一个类加载器需要做什么？</h4> <p>只需要做一件事，就是定义自己的 findClass 就可以了。</p> <p>具体来说：</p> <ul><li><p>继承 ClassLoader</p></li> <li><p>重写模板方法 findClass</p> <ul><li>调用 defineClass(byte[] -&gt; Class clazz)</li></ul></li> <li><p>加密：可自定义类加载器加载自加密的 class</p> <ul><li>防止反编译</li> <li>防止篡改</li></ul></li></ul> <p>代码如下：</p> <p>首先继承 ClassLoader 这个类</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 自定义类加载器继承自ClassLoader</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">T006_MSBClassLoader</span> <span class="token keyword">extends</span> <span class="token class-name">ClassLoader</span> <span class="token punctuation">{</span>

    <span class="token comment">// 重写findClass方法，用于加载类字节码</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">findClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 根据类名构建文件路径</span>
        <span class="token class-name">File</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;c:/test/&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">&quot;.class&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// 读取字节码文件</span>
            <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ByteArrayOutputStream</span> baos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token comment">// 读取文件内容并写入字节数组输出流</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b<span class="token operator">=</span>fis<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// 将字节数组转换为字节数组</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> baos<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            baos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭流</span>

            <span class="token comment">// 使用defineClass方法定义并返回类</span>
            <span class="token keyword">return</span> <span class="token function">defineClass</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> bytes<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> bytes<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 若加载失败，则调用父类的findClass方法</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">findClass</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// throws ClassNotFoundException</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 主函数</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// 创建自定义类加载器实例</span>
        <span class="token class-name">ClassLoader</span> l <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">T006_MSBClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 通过自定义类加载器加载类</span>
        <span class="token class-name">Class</span> clazz <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">&quot;com.mashibing.jvm.Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Class</span> clazz1 <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">&quot;com.mashibing.jvm.Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 输出两次加载的类是否相同</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>clazz <span class="token operator">==</span> clazz1<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 创建加载的类的实例并调用方法</span>
        <span class="token class-name">Hello</span> h <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Hello</span><span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        h<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 输出类加载器信息</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出自定义类加载器的类加载器</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出自定义类加载器的父类加载器</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getSystemClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出系统类加载器</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Hello</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello JVM!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div><p>这段代码实现了一个自定义的类加载器 <code>T006_MSBClassLoader</code>，该类加载器继承自 <code>ClassLoader</code>，重写了 <code>findClass</code> 方法来加载类的字节码。在主函数中，使用这个自定义的类加载器加载类，并输出加载的类是否相同，然后创建该类的实例并调用方法。最后，输出了自定义类加载器的类加载器和父类加载器信息，以及系统类加载器的信息。这种自定义类加载器的方式允许你从非标准的位置加载类文件，并且可以通过不同的类加载器实现类的隔离。</p> <hr> <p><code>defineClass</code> 方法是 <code>ClassLoader</code> 类中的一个重要方法，用于将字节数组转换为一个 <code>Class</code> 对象。该方法的作用是将一个【字节数组中的类字节码】转换为一个【Java 类的实例】。当一个类加载器调用 <code>defineClass</code> 方法时，它会将字节数组中的类字节码转换为一个 <code>Class</code> 对象，并返回该对象。(不会验证字节码的正确性)</p> <blockquote><p>输出结果</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>true
Hello JVM!
sun.misc.Launcher$AppClassLoader@18b4aac2
sun.misc.Launcher$AppClassLoader@18b4aac2
sun.misc.Launcher$AppClassLoader@18b4aac2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="加密"><a href="#加密" class="header-anchor">#</a> 加密</h4> <p>大家都知道 java 的代码 class 文件很容易就被反编译了。</p> <p><em>但是我要是定义自己的格式，我不想让别人反编译，这时候怎么办？</em></p> <p>你可以通过自定义的 class loader 来进行。然后在写逻辑的时候加一个加密操作。</p> <h3 id="编译器"><a href="#编译器" class="header-anchor">#</a> 编译器</h3> <p>三大模式：</p> <ul><li>解释器（<em>bytecode intepreter</em>） -- 解释模式</li> <li>JIT（<em>Just In-Time compiler</em>） -- 编译模式</li> <li>混合模式
<ul><li>混合使用解释器 + 热点代码编译（编译成本地代码，就不用在解释器里面解释来执行了，效率提升）</li> <li>起始阶段采用解释执行</li> <li>热点代码检测
<ul><li>多次被调用的方法(方法计数器:监测方法执行频率)</li> <li>多次被调用的循环(循环计数器:检测循环执行频率)</li> <li>进行编译</li></ul></li></ul></li></ul> <p><em>为什么不干脆直接编译成本地代码，那执行效率不更高吗？</em></p> <p>有两个原因。</p> <ol><li>第一，Java 的解释器，现在它的效率也已经非常高了，在一些简单代码的执行上，它并不输于你编译成本地代码。</li> <li>第二，如果你一个执行的文件特别多，各种各样的类库的时候，好几十个 class，你上来二话不说先在内存里编译一遍，这个启动过程会长得吓人。所以它现在默认的模式是混合模式。</li></ol> <p><em>可以用指明参数的方式指定用什么模式</em></p> <ol><li><p>-Xmixed 默认为<strong>混合</strong>模式</p> <p>开始解释执行，启动速度较快，对热点代码实行检测和编译</p></li> <li><p>-Xint 使用<strong>解释</strong>模式，启动很快，执行稍慢</p></li> <li><p>-Xcomp 使用<strong>纯编译</strong>模式，执行很快，启动很慢（要编译的类少的时候，启动也会很快）</p></li></ol> <h3 id="懒加载"><a href="#懒加载" class="header-anchor">#</a> 懒加载</h3> <p>lazyloading</p> <ul><li>严格讲应该叫 lazylnitializing</li> <li>JVM 规范并没有规定何时加载</li> <li>但是严格规定了什么时候必须初始化，五种情况
<ol><li>使用 new，getstatic，putstatic，invokestatic 指令时，访问 final 变量除外</li> <li>java.lang.reflect 对类进行反射调用时</li> <li>初始化子类的时候，父类必须首先初始化</li> <li>虚拟机启动时，被执行的主类必须初始化</li> <li>动态语言支持 java.lang.invoke.MethodHandle 解析的结果为 REF_getstatic, REF_putstatic, REF_invokestatic 的方法句柄时，该类必须初始化</li></ol></li></ul> <h3 id="拓展知识"><a href="#拓展知识" class="header-anchor">#</a> 拓展知识</h3> <h4 id="双亲委派如何打破"><a href="#双亲委派如何打破" class="header-anchor">#</a> 双亲委派如何打破？</h4> <p><font color="red">parent 是如何指定的，打破双亲委派</font></p> <ol><li>用 <code>super(parent)</code> 指定</li> <li>双亲委派的打破
<ol><li>如何打破：重写 <code>loadClass()</code> 方法</li> <li>何时打破过？
<ol><li>JDK1.2 之前，自定义 ClassLoader 都必须重写 loadClass()</li> <li>ThreadContextClassLoader 可以实现基础类调用实现类代码，通过 thread.setContextClassLoader 指定</li> <li>热启动，热部署
<ul><li>osgi tomcat 都有自己的模块指定 classloader（可以加载同一类库的不同版本）</li></ul></li></ol></li></ol></li></ol> <h4 id="类加载器涉及到了哪些设计模式"><a href="#类加载器涉及到了哪些设计模式" class="header-anchor">#</a> 类加载器涉及到了哪些设计模式？</h4> <p>在 Java 虚拟机 (JVM) 中的类加载器 (ClassLoader) 实现中，通常使用了以下两种设计模式：</p> <ol><li><strong>委托模式</strong> (Delegation Pattern)：ClassLoader 的实现通常使用了委托模式来处理类加载请求。委托模式指的是当一个对象收到请求时，它将请求委托给其他对象来处理。在类加载器的情况下，当一个类加载器接收到加载类的请求时，它首先会将请求委托给父类加载器进行处理。如果父类加载器无法加载该类，子类加载器才会尝试加载类。这种委托模式的设计方式可以实现类加载器的层次结构，从而实现类加载器的隔离和类加载的委派。</li> <li><strong>单一职责模式</strong> (Single Responsibility Pattern)：ClassLoader 的主要责任是加载类文件并定义对应的类。ClassLoader 的设计符合单一职责模式，即一个类应该只负责一项职责。ClassLoader 将类加载的职责封装在一个独立的类中，从而使得类加载的逻辑与其他功能解耦，提高了代码的可维护性和可扩展性。</li></ol> <p>除了委托模式和单一职责模式，ClassLoader 的实现可能还涉及其他设计模式，具体取决于实际的实现细节和需求。例如，一些类加载器的缓存机制可能使用了享元模式 (Flyweight Pattern) 来提高性能和资源利用效率。</p></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/9/25 11:16:13</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/277c5b/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Java内存管理总结</div></a> <a href="/pages/ff3623/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">JVM常问</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/277c5b/" class="prev">Java内存管理总结</a></span> <span class="next"><a href="/pages/ff3623/">JVM常问</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:2691357857@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/cmty256" title="Github" target="_blank" class="iconfont icon-github"></a><a href="https://blog.csdn.net/qq_54088234?spm=1011.2124.3001.5343" title="CSDN" target="_blank" class="iconfont icon-csdn"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2025
    <span>沉梦听雨 | <a href="https://gitee.com/dream-deeply-tyu" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><canvas id="vuepress-canvas-cursor"></canvas><!----><div></div></div></div>
    <script src="/assets/js/app.630ba73d.js" defer></script><script src="/assets/js/2.02bc9df6.js" defer></script><script src="/assets/js/30.ca1ed9ba.js" defer></script><script src="/assets/js/6.9155b086.js" defer></script>
  </body>
</html>
