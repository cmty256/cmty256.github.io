<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Elasticsearch入门 | 沉梦听雨的编程指南</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="https://cmty256.github.io/imgs-blog/logo/白云.38zbldnhh180.jpg">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3077305_pt8umhrn4k9.css">
    <script>
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "https://hm.baidu.com/hm.js?04a2517feeaf9f0d4d507cee97057d7c";
              var s = document.getElementsByTagName("script")[0]; 
              s.parentNode.insertBefore(hm, s);
            })();
          </script>
    <meta name="description" content="满招损，谦受益">
    <meta name="msvalidate.01" content="C6CD7D17F253A4A17B19D2EEBC95189E">
    <meta name="google-site-verification" content="1_X5AziuUEYcv2PowGXK9yiTwKre1owdUNTNB28UwQo">
    <meta name="keywords" content="编程分享, 开发, 程序员, Java, 计算机, IT, 八股">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.3543fb06.css" as="style"><link rel="preload" href="/assets/js/app.cded0381.js" as="script"><link rel="preload" href="/assets/js/2.02bc9df6.js" as="script"><link rel="preload" href="/assets/js/189.409deb85.js" as="script"><link rel="preload" href="/assets/js/6.9155b086.js" as="script"><link rel="prefetch" href="/assets/js/10.5c19a6fa.js"><link rel="prefetch" href="/assets/js/100.46c61337.js"><link rel="prefetch" href="/assets/js/101.058d4bcb.js"><link rel="prefetch" href="/assets/js/102.133876a6.js"><link rel="prefetch" href="/assets/js/103.bd6500f4.js"><link rel="prefetch" href="/assets/js/104.e8571922.js"><link rel="prefetch" href="/assets/js/105.fd27872d.js"><link rel="prefetch" href="/assets/js/106.bfd268a8.js"><link rel="prefetch" href="/assets/js/107.58a9cb6c.js"><link rel="prefetch" href="/assets/js/108.7311c481.js"><link rel="prefetch" href="/assets/js/109.38b10e69.js"><link rel="prefetch" href="/assets/js/11.028ac22d.js"><link rel="prefetch" href="/assets/js/110.082e0024.js"><link rel="prefetch" href="/assets/js/111.f069effc.js"><link rel="prefetch" href="/assets/js/112.fd8da57a.js"><link rel="prefetch" href="/assets/js/113.29f359e9.js"><link rel="prefetch" href="/assets/js/114.5979e515.js"><link rel="prefetch" href="/assets/js/115.a9486ced.js"><link rel="prefetch" href="/assets/js/116.a6262a44.js"><link rel="prefetch" href="/assets/js/117.74681f9c.js"><link rel="prefetch" href="/assets/js/118.cc4246eb.js"><link rel="prefetch" href="/assets/js/119.c6fb19d8.js"><link rel="prefetch" href="/assets/js/12.6d898115.js"><link rel="prefetch" href="/assets/js/120.0f7f924a.js"><link rel="prefetch" href="/assets/js/121.cb2768e3.js"><link rel="prefetch" href="/assets/js/122.c44df791.js"><link rel="prefetch" href="/assets/js/123.3bbdd0b1.js"><link rel="prefetch" href="/assets/js/124.e7ed285c.js"><link rel="prefetch" href="/assets/js/125.0e08c027.js"><link rel="prefetch" href="/assets/js/126.dd0f5e6f.js"><link rel="prefetch" href="/assets/js/127.645cdaaa.js"><link rel="prefetch" href="/assets/js/128.9da5b3f9.js"><link rel="prefetch" href="/assets/js/129.306b5040.js"><link rel="prefetch" href="/assets/js/13.2bacd6e3.js"><link rel="prefetch" href="/assets/js/130.9b1d716c.js"><link rel="prefetch" href="/assets/js/131.cbd95e06.js"><link rel="prefetch" href="/assets/js/132.73dfbdfb.js"><link rel="prefetch" href="/assets/js/133.7c026ef8.js"><link rel="prefetch" href="/assets/js/134.ca62eced.js"><link rel="prefetch" href="/assets/js/135.8b456217.js"><link rel="prefetch" href="/assets/js/136.25ec99b7.js"><link rel="prefetch" href="/assets/js/137.9db0e6fa.js"><link rel="prefetch" href="/assets/js/138.69ddd296.js"><link rel="prefetch" href="/assets/js/139.890407fd.js"><link rel="prefetch" href="/assets/js/14.01cbd032.js"><link rel="prefetch" href="/assets/js/140.44a2eab4.js"><link rel="prefetch" href="/assets/js/141.2e995a51.js"><link rel="prefetch" href="/assets/js/142.ccf0802b.js"><link rel="prefetch" href="/assets/js/143.8f6a8699.js"><link rel="prefetch" href="/assets/js/144.3580c8c9.js"><link rel="prefetch" href="/assets/js/145.4b20272b.js"><link rel="prefetch" href="/assets/js/146.07a8752d.js"><link rel="prefetch" href="/assets/js/147.d20e25eb.js"><link rel="prefetch" href="/assets/js/148.afdb7aab.js"><link rel="prefetch" href="/assets/js/149.030188a6.js"><link rel="prefetch" href="/assets/js/15.8871e9cc.js"><link rel="prefetch" href="/assets/js/150.1e5cff5a.js"><link rel="prefetch" href="/assets/js/151.0fa8a9d1.js"><link rel="prefetch" href="/assets/js/152.e08d81b4.js"><link rel="prefetch" href="/assets/js/153.33b50a51.js"><link rel="prefetch" href="/assets/js/154.d4a382b5.js"><link rel="prefetch" href="/assets/js/155.2e07bfb8.js"><link rel="prefetch" href="/assets/js/156.1b8fe242.js"><link rel="prefetch" href="/assets/js/157.7a3b351a.js"><link rel="prefetch" href="/assets/js/158.d2090af5.js"><link rel="prefetch" href="/assets/js/159.973260e8.js"><link rel="prefetch" href="/assets/js/16.04070497.js"><link rel="prefetch" href="/assets/js/160.8d84a3ad.js"><link rel="prefetch" href="/assets/js/161.79e5b209.js"><link rel="prefetch" href="/assets/js/162.712031a9.js"><link rel="prefetch" href="/assets/js/163.e65e8c6a.js"><link rel="prefetch" href="/assets/js/164.cc33c998.js"><link rel="prefetch" href="/assets/js/165.72d92a35.js"><link rel="prefetch" href="/assets/js/166.338ad301.js"><link rel="prefetch" href="/assets/js/167.3d6e6c9c.js"><link rel="prefetch" href="/assets/js/168.e9958b50.js"><link rel="prefetch" href="/assets/js/169.c1bbdb9c.js"><link rel="prefetch" href="/assets/js/17.31067a11.js"><link rel="prefetch" href="/assets/js/170.b1025d89.js"><link rel="prefetch" href="/assets/js/171.9a4f2604.js"><link rel="prefetch" href="/assets/js/172.d6992b92.js"><link rel="prefetch" href="/assets/js/173.0a3d7308.js"><link rel="prefetch" href="/assets/js/174.dac57687.js"><link rel="prefetch" href="/assets/js/175.cbdb3a5f.js"><link rel="prefetch" href="/assets/js/176.79256074.js"><link rel="prefetch" href="/assets/js/177.29ba00ec.js"><link rel="prefetch" href="/assets/js/178.a1fddd7f.js"><link rel="prefetch" href="/assets/js/179.53214259.js"><link rel="prefetch" href="/assets/js/18.2a3a7cac.js"><link rel="prefetch" href="/assets/js/180.ac34cca6.js"><link rel="prefetch" href="/assets/js/181.6137a82a.js"><link rel="prefetch" href="/assets/js/182.04240bed.js"><link rel="prefetch" href="/assets/js/183.40912912.js"><link rel="prefetch" href="/assets/js/184.c46fb648.js"><link rel="prefetch" href="/assets/js/185.97ce4023.js"><link rel="prefetch" href="/assets/js/186.d8dc85cc.js"><link rel="prefetch" href="/assets/js/187.fa09e1c8.js"><link rel="prefetch" href="/assets/js/188.a093a51c.js"><link rel="prefetch" href="/assets/js/19.b4f05b00.js"><link rel="prefetch" href="/assets/js/190.26695038.js"><link rel="prefetch" href="/assets/js/191.a8f3d937.js"><link rel="prefetch" href="/assets/js/192.dd26bb07.js"><link rel="prefetch" href="/assets/js/193.c11aaed8.js"><link rel="prefetch" href="/assets/js/194.5ccb3b7e.js"><link rel="prefetch" href="/assets/js/195.860fe3bb.js"><link rel="prefetch" href="/assets/js/196.f1d23080.js"><link rel="prefetch" href="/assets/js/197.e5bd159d.js"><link rel="prefetch" href="/assets/js/198.e70ba884.js"><link rel="prefetch" href="/assets/js/199.dae834c7.js"><link rel="prefetch" href="/assets/js/20.68d82b3e.js"><link rel="prefetch" href="/assets/js/200.2a85e97f.js"><link rel="prefetch" href="/assets/js/201.7b4e2761.js"><link rel="prefetch" href="/assets/js/202.a487e70e.js"><link rel="prefetch" href="/assets/js/203.69f82187.js"><link rel="prefetch" href="/assets/js/204.85e42ed5.js"><link rel="prefetch" href="/assets/js/205.31df88b1.js"><link rel="prefetch" href="/assets/js/206.4921e6a6.js"><link rel="prefetch" href="/assets/js/207.c330e750.js"><link rel="prefetch" href="/assets/js/208.296d76ee.js"><link rel="prefetch" href="/assets/js/209.0fa577f1.js"><link rel="prefetch" href="/assets/js/21.f0611f36.js"><link rel="prefetch" href="/assets/js/210.bc66d616.js"><link rel="prefetch" href="/assets/js/211.acce31bd.js"><link rel="prefetch" href="/assets/js/212.ef576a95.js"><link rel="prefetch" href="/assets/js/213.ac90cbf8.js"><link rel="prefetch" href="/assets/js/214.cec43fb1.js"><link rel="prefetch" href="/assets/js/215.42b4183e.js"><link rel="prefetch" href="/assets/js/216.331e92ec.js"><link rel="prefetch" href="/assets/js/217.9e068f4a.js"><link rel="prefetch" href="/assets/js/218.b55e76d7.js"><link rel="prefetch" href="/assets/js/219.8b85ec86.js"><link rel="prefetch" href="/assets/js/22.b38f0314.js"><link rel="prefetch" href="/assets/js/220.86bc1b47.js"><link rel="prefetch" href="/assets/js/221.f3406443.js"><link rel="prefetch" href="/assets/js/222.045904df.js"><link rel="prefetch" href="/assets/js/223.bdc9fff0.js"><link rel="prefetch" href="/assets/js/224.d9f4397c.js"><link rel="prefetch" href="/assets/js/225.5737361f.js"><link rel="prefetch" href="/assets/js/226.2a791116.js"><link rel="prefetch" href="/assets/js/227.bf772079.js"><link rel="prefetch" href="/assets/js/228.7b4d05fe.js"><link rel="prefetch" href="/assets/js/229.13784066.js"><link rel="prefetch" href="/assets/js/23.63f50e9a.js"><link rel="prefetch" href="/assets/js/230.d5913bc9.js"><link rel="prefetch" href="/assets/js/231.af7b692a.js"><link rel="prefetch" href="/assets/js/232.c3e34baf.js"><link rel="prefetch" href="/assets/js/233.ebbfec94.js"><link rel="prefetch" href="/assets/js/234.e9490c4d.js"><link rel="prefetch" href="/assets/js/235.f1bfde5b.js"><link rel="prefetch" href="/assets/js/236.6992fcfb.js"><link rel="prefetch" href="/assets/js/237.8a97b87a.js"><link rel="prefetch" href="/assets/js/238.a629a0f9.js"><link rel="prefetch" href="/assets/js/239.8192c8af.js"><link rel="prefetch" href="/assets/js/24.fe922d73.js"><link rel="prefetch" href="/assets/js/240.931a16a0.js"><link rel="prefetch" href="/assets/js/241.2596bcd0.js"><link rel="prefetch" href="/assets/js/242.48efe224.js"><link rel="prefetch" href="/assets/js/243.4d3b7708.js"><link rel="prefetch" href="/assets/js/244.aaffe3bf.js"><link rel="prefetch" href="/assets/js/245.39336a0e.js"><link rel="prefetch" href="/assets/js/246.d026df87.js"><link rel="prefetch" href="/assets/js/247.2dd8ffb7.js"><link rel="prefetch" href="/assets/js/248.881725cb.js"><link rel="prefetch" href="/assets/js/249.a0e09544.js"><link rel="prefetch" href="/assets/js/25.a4f99aec.js"><link rel="prefetch" href="/assets/js/250.d89bb760.js"><link rel="prefetch" href="/assets/js/251.635658f2.js"><link rel="prefetch" href="/assets/js/252.0364cc51.js"><link rel="prefetch" href="/assets/js/253.1d1e13a4.js"><link rel="prefetch" href="/assets/js/254.f366e73f.js"><link rel="prefetch" href="/assets/js/255.efdaedfa.js"><link rel="prefetch" href="/assets/js/256.594baaed.js"><link rel="prefetch" href="/assets/js/257.7a143ed1.js"><link rel="prefetch" href="/assets/js/258.ebe9cda7.js"><link rel="prefetch" href="/assets/js/259.f280ad87.js"><link rel="prefetch" href="/assets/js/26.d2338de5.js"><link rel="prefetch" href="/assets/js/260.959a94cd.js"><link rel="prefetch" href="/assets/js/261.d056cdb3.js"><link rel="prefetch" href="/assets/js/262.7a4d8d9a.js"><link rel="prefetch" href="/assets/js/263.d6343df5.js"><link rel="prefetch" href="/assets/js/264.8e6806e6.js"><link rel="prefetch" href="/assets/js/265.ee873080.js"><link rel="prefetch" href="/assets/js/266.771bcf47.js"><link rel="prefetch" href="/assets/js/267.c941b41d.js"><link rel="prefetch" href="/assets/js/268.4f402cef.js"><link rel="prefetch" href="/assets/js/269.50701aed.js"><link rel="prefetch" href="/assets/js/27.9ec638c9.js"><link rel="prefetch" href="/assets/js/270.f2c02404.js"><link rel="prefetch" href="/assets/js/271.87dced61.js"><link rel="prefetch" href="/assets/js/272.0bfdd5a0.js"><link rel="prefetch" href="/assets/js/273.14662bfe.js"><link rel="prefetch" href="/assets/js/274.845b880b.js"><link rel="prefetch" href="/assets/js/275.b9962229.js"><link rel="prefetch" href="/assets/js/276.b9f3cca1.js"><link rel="prefetch" href="/assets/js/277.f79747f5.js"><link rel="prefetch" href="/assets/js/278.531f7dc8.js"><link rel="prefetch" href="/assets/js/279.e142b73a.js"><link rel="prefetch" href="/assets/js/28.fdbdecd3.js"><link rel="prefetch" href="/assets/js/280.2d44e8aa.js"><link rel="prefetch" href="/assets/js/281.16672baf.js"><link rel="prefetch" href="/assets/js/282.6d47850f.js"><link rel="prefetch" href="/assets/js/283.e24300ac.js"><link rel="prefetch" href="/assets/js/284.4db9eccb.js"><link rel="prefetch" href="/assets/js/285.2691dcae.js"><link rel="prefetch" href="/assets/js/286.6c84442d.js"><link rel="prefetch" href="/assets/js/287.8d720e98.js"><link rel="prefetch" href="/assets/js/288.88cb8890.js"><link rel="prefetch" href="/assets/js/289.83b18fa0.js"><link rel="prefetch" href="/assets/js/29.b1393548.js"><link rel="prefetch" href="/assets/js/290.79b265ac.js"><link rel="prefetch" href="/assets/js/291.fca3f174.js"><link rel="prefetch" href="/assets/js/292.7201a80b.js"><link rel="prefetch" href="/assets/js/293.3f79a0b4.js"><link rel="prefetch" href="/assets/js/294.09e25241.js"><link rel="prefetch" href="/assets/js/295.97f9827e.js"><link rel="prefetch" href="/assets/js/296.8ccd3c5b.js"><link rel="prefetch" href="/assets/js/297.70fa6c50.js"><link rel="prefetch" href="/assets/js/3.931a19c0.js"><link rel="prefetch" href="/assets/js/30.4b62329a.js"><link rel="prefetch" href="/assets/js/31.66a2da63.js"><link rel="prefetch" href="/assets/js/32.87aab090.js"><link rel="prefetch" href="/assets/js/33.490258ea.js"><link rel="prefetch" href="/assets/js/34.b533dc5c.js"><link rel="prefetch" href="/assets/js/35.a76efbbd.js"><link rel="prefetch" href="/assets/js/36.89a6af66.js"><link rel="prefetch" href="/assets/js/37.fad25f70.js"><link rel="prefetch" href="/assets/js/38.7910dc4d.js"><link rel="prefetch" href="/assets/js/39.432ee650.js"><link rel="prefetch" href="/assets/js/4.76529d39.js"><link rel="prefetch" href="/assets/js/40.0105d75b.js"><link rel="prefetch" href="/assets/js/41.301d1785.js"><link rel="prefetch" href="/assets/js/42.1ae0a844.js"><link rel="prefetch" href="/assets/js/43.bc31000b.js"><link rel="prefetch" href="/assets/js/44.8971df73.js"><link rel="prefetch" href="/assets/js/45.1650c7f5.js"><link rel="prefetch" href="/assets/js/46.34dedaec.js"><link rel="prefetch" href="/assets/js/47.e3d09cf0.js"><link rel="prefetch" href="/assets/js/48.dfdb2c5c.js"><link rel="prefetch" href="/assets/js/49.c84594af.js"><link rel="prefetch" href="/assets/js/5.f7dbece9.js"><link rel="prefetch" href="/assets/js/50.35bf9e9c.js"><link rel="prefetch" href="/assets/js/51.1ee87d4c.js"><link rel="prefetch" href="/assets/js/52.25381af8.js"><link rel="prefetch" href="/assets/js/53.9d03b2f9.js"><link rel="prefetch" href="/assets/js/54.64a88bde.js"><link rel="prefetch" href="/assets/js/55.16d9ff90.js"><link rel="prefetch" href="/assets/js/56.b4a142b5.js"><link rel="prefetch" href="/assets/js/57.8d783a1a.js"><link rel="prefetch" href="/assets/js/58.827b8088.js"><link rel="prefetch" href="/assets/js/59.8578679d.js"><link rel="prefetch" href="/assets/js/60.ddbb613b.js"><link rel="prefetch" href="/assets/js/61.a661463b.js"><link rel="prefetch" href="/assets/js/62.5d54f410.js"><link rel="prefetch" href="/assets/js/63.86bad1cc.js"><link rel="prefetch" href="/assets/js/64.17d2f0de.js"><link rel="prefetch" href="/assets/js/65.b8b1a69b.js"><link rel="prefetch" href="/assets/js/66.aa444f29.js"><link rel="prefetch" href="/assets/js/67.97fd03c3.js"><link rel="prefetch" href="/assets/js/68.b754b113.js"><link rel="prefetch" href="/assets/js/69.00a40b6e.js"><link rel="prefetch" href="/assets/js/7.92c41863.js"><link rel="prefetch" href="/assets/js/70.38ea0b71.js"><link rel="prefetch" href="/assets/js/71.c0963c64.js"><link rel="prefetch" href="/assets/js/72.249174fc.js"><link rel="prefetch" href="/assets/js/73.75bd7bab.js"><link rel="prefetch" href="/assets/js/74.33c414aa.js"><link rel="prefetch" href="/assets/js/75.fee5afe5.js"><link rel="prefetch" href="/assets/js/76.f2b95f81.js"><link rel="prefetch" href="/assets/js/77.b7d37285.js"><link rel="prefetch" href="/assets/js/78.d8277e74.js"><link rel="prefetch" href="/assets/js/79.65eb1c72.js"><link rel="prefetch" href="/assets/js/8.0efb528e.js"><link rel="prefetch" href="/assets/js/80.0d696065.js"><link rel="prefetch" href="/assets/js/81.25b301f3.js"><link rel="prefetch" href="/assets/js/82.5a980040.js"><link rel="prefetch" href="/assets/js/83.b6c6e0f2.js"><link rel="prefetch" href="/assets/js/84.1022a83a.js"><link rel="prefetch" href="/assets/js/85.5274de15.js"><link rel="prefetch" href="/assets/js/86.76700757.js"><link rel="prefetch" href="/assets/js/87.01d144aa.js"><link rel="prefetch" href="/assets/js/88.492935a7.js"><link rel="prefetch" href="/assets/js/89.4b0e5c1a.js"><link rel="prefetch" href="/assets/js/9.d5d32217.js"><link rel="prefetch" href="/assets/js/90.f25b68c7.js"><link rel="prefetch" href="/assets/js/91.33075a43.js"><link rel="prefetch" href="/assets/js/92.dbd26e4b.js"><link rel="prefetch" href="/assets/js/93.fa27ab02.js"><link rel="prefetch" href="/assets/js/94.1e52fbe4.js"><link rel="prefetch" href="/assets/js/95.f9587b84.js"><link rel="prefetch" href="/assets/js/96.6c7e28db.js"><link rel="prefetch" href="/assets/js/97.81082d82.js"><link rel="prefetch" href="/assets/js/98.f3b99a37.js"><link rel="prefetch" href="/assets/js/99.4d27a90b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3543fb06.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://cmty256.github.io/imgs-blog/logo/白云.38zbldnhh180.jpg" alt="沉梦听雨的编程指南" class="logo"> <span class="site-name can-hide">沉梦听雨的编程指南</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/11aacc/" class="nav-link">基础篇</a></li><li class="dropdown-item"><!----> <a href="/pages/2e780e/" class="nav-link">集合篇</a></li><li class="dropdown-item"><!----> <a href="/pages/846d88/" class="nav-link">并发篇</a></li><li class="dropdown-item"><!----> <a href="/pages/562a37/" class="nav-link">JVM</a></li><li class="dropdown-item"><!----> <a href="/pages/a5d9a6/" class="nav-link">新特性</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><!----> <span class="title" style="display:;">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/7b1cb2/" class="nav-link">计算机网络</a></li><li class="dropdown-item"><!----> <a href="/pages/6048a8/" class="nav-link">操作系统</a></li><li class="dropdown-item"><!----> <a href="/pages/3b34ba/" class="nav-link">数据结构与算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/efa3f2/" class="nav-link">基础篇</a></li><li class="dropdown-item"><!----> <a href="/pages/ccc445/" class="nav-link">MySql</a></li><li class="dropdown-item"><!----> <a href="/pages/54616e/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/pages/980c9c/" class="nav-link">达梦数据库</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用框架" class="dropdown-title"><!----> <span class="title" style="display:;">常用框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/4969e6/" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/pages/72bcc7/" class="nav-link">SpringBoot</a></li><li class="dropdown-item"><!----> <a href="/pages/93b888/" class="nav-link">Mybatis</a></li><li class="dropdown-item"><!----> <a href="/pages/a54fbc/" class="nav-link">Shiro</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="系统设计" class="dropdown-title"><!----> <span class="title" style="display:;">系统设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/649916/" class="nav-link">设计须知</a></li><li class="dropdown-item"><!----> <a href="/pages/3fcc71/" class="nav-link">UML画图</a></li><li class="dropdown-item"><!----> <a href="/pages/793d0a/" class="nav-link">权限校验</a></li><li class="dropdown-item"><!----> <a href="/pages/6ea7eb/" class="nav-link">设计模式</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务" class="dropdown-title"><!----> <span class="title" style="display:;">微服务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/c6222f/" class="nav-link">API网关</a></li><li class="dropdown-item"><!----> <a href="/pages//" class="nav-link">RPC</a></li><li class="dropdown-item"><!----> <a href="/pages/2f66e5/" class="nav-link">消息队列</a></li><li class="dropdown-item"><!----> <a href="/pages/75e0cf/" class="nav-link">SpringCloud</a></li><li class="dropdown-item"><!----> <a href="/pages/957695/" class="nav-link">分布式事务</a></li><li class="dropdown-item"><!----> <a href="/pages/2beec7/" class="nav-link">云存储</a></li><li class="dropdown-item"><!----> <a href="/pages/9eed4b/" aria-current="page" class="nav-link router-link-exact-active router-link-active">搜索引擎</a></li><li class="dropdown-item"><!----> <a href="/pages/9f26dc/" class="nav-link">多媒体框架</a></li><li class="dropdown-item"><!----> <a href="/pages/412fe7/" class="nav-link">虚拟机</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发日常" class="dropdown-title"><!----> <span class="title" style="display:;">开发日常</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/626493/" class="nav-link">开发工具篇</a></li><li class="dropdown-item"><!----> <a href="/pages/bdbd1f/" class="nav-link">工具库篇</a></li><li class="dropdown-item"><!----> <a href="/pages/cc202d/" class="nav-link">开发技巧篇</a></li><li class="dropdown-item"><!----> <a href="/pages/dea09d/" class="nav-link">工具类系列</a></li><li class="dropdown-item"><!----> <a href="/pages/3cd6be/" class="nav-link">随笔</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端学习" class="dropdown-title"><!----> <span class="title" style="display:;">前端学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/3eeffb/" class="nav-link">前端环境搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/99897f/" class="nav-link">HTML与CSS</a></li><li class="dropdown-item"><!----> <a href="/pages/51542d/" class="nav-link">JS学习</a></li><li class="dropdown-item"><!----> <a href="/pages/3c013f/" class="nav-link">Axios入门</a></li><li class="dropdown-item"><!----> <a href="/pages/47c242/" class="nav-link">Vue Router入门</a></li><li class="dropdown-item"><!----> <a href="/pages/51542d/" class="nav-link">Pinia入门</a></li><li class="dropdown-item"><!----> <a href="/pages/803f9d/" class="nav-link">Vue3入门</a></li><li class="dropdown-item"><!----> <a href="/pages/ca4cfb/" class="nav-link">Vue3进阶</a></li><li class="dropdown-item"><!----> <a href="/pages/50e8d3/" class="nav-link">黑马Vue3</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目笔记" class="dropdown-title"><!----> <span class="title" style="display:;">项目笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/ebb9f9/" class="nav-link">脚手架搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/fbc2fc/" class="nav-link">瑞吉外卖</a></li><li class="dropdown-item"><!----> <a href="/pages/ee76ba/" class="nav-link">黑马点评</a></li><li class="dropdown-item"><!----> <a href="/pages/fa01b6/" class="nav-link">vue-blog</a></li><li class="dropdown-item"><!----> <a href="/pages/b363e2/" class="nav-link">沉梦接口开放平台</a></li><li class="dropdown-item"><!----> <a href="/pages/72b962/" class="nav-link">用户中心</a></li><li class="dropdown-item"><!----> <a href="/pages/8baa93/" class="nav-link">聚合搜索平台</a></li><li class="dropdown-item"><!----> <a href="/pages/a6b2f3/" class="nav-link">仿12306项目</a></li><li class="dropdown-item"><!----> <a href="/pages/b85237/" class="nav-link">壁纸小程序项目</a></li><li class="dropdown-item"><!----> <a href="/pages/a2c11e/" class="nav-link">RuoYi-Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它" class="dropdown-title"><!----> <span class="title" style="display:;">其它</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/fa256e/" class="nav-link">博客搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/335531/" class="nav-link">网站收藏箱</a></li><li class="dropdown-item"><!----> <a href="/pages/94109b/" class="nav-link">断墨寻径摘录</a></li><li class="dropdown-item"><!----> <a href="/pages/22f2c8/" class="nav-link">费曼学习法</a></li></ul></div></div> <a href="https://github.com/cmty256" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cmty256.github.io/picx-images-hosting/logo/0bd74b62680d5dc2d82d50efcac4546.8adfdu46qo.jpg"> <div class="blogger-info"><h3>沉梦听雨</h3> <span>时间是最好的浸渍剂，而沉淀是最好的提纯器🚀</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/11aacc/" class="nav-link">基础篇</a></li><li class="dropdown-item"><!----> <a href="/pages/2e780e/" class="nav-link">集合篇</a></li><li class="dropdown-item"><!----> <a href="/pages/846d88/" class="nav-link">并发篇</a></li><li class="dropdown-item"><!----> <a href="/pages/562a37/" class="nav-link">JVM</a></li><li class="dropdown-item"><!----> <a href="/pages/a5d9a6/" class="nav-link">新特性</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><!----> <span class="title" style="display:;">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/7b1cb2/" class="nav-link">计算机网络</a></li><li class="dropdown-item"><!----> <a href="/pages/6048a8/" class="nav-link">操作系统</a></li><li class="dropdown-item"><!----> <a href="/pages/3b34ba/" class="nav-link">数据结构与算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/efa3f2/" class="nav-link">基础篇</a></li><li class="dropdown-item"><!----> <a href="/pages/ccc445/" class="nav-link">MySql</a></li><li class="dropdown-item"><!----> <a href="/pages/54616e/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/pages/980c9c/" class="nav-link">达梦数据库</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常用框架" class="dropdown-title"><!----> <span class="title" style="display:;">常用框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/4969e6/" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/pages/72bcc7/" class="nav-link">SpringBoot</a></li><li class="dropdown-item"><!----> <a href="/pages/93b888/" class="nav-link">Mybatis</a></li><li class="dropdown-item"><!----> <a href="/pages/a54fbc/" class="nav-link">Shiro</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="系统设计" class="dropdown-title"><!----> <span class="title" style="display:;">系统设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/649916/" class="nav-link">设计须知</a></li><li class="dropdown-item"><!----> <a href="/pages/3fcc71/" class="nav-link">UML画图</a></li><li class="dropdown-item"><!----> <a href="/pages/793d0a/" class="nav-link">权限校验</a></li><li class="dropdown-item"><!----> <a href="/pages/6ea7eb/" class="nav-link">设计模式</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微服务" class="dropdown-title"><!----> <span class="title" style="display:;">微服务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/c6222f/" class="nav-link">API网关</a></li><li class="dropdown-item"><!----> <a href="/pages//" class="nav-link">RPC</a></li><li class="dropdown-item"><!----> <a href="/pages/2f66e5/" class="nav-link">消息队列</a></li><li class="dropdown-item"><!----> <a href="/pages/75e0cf/" class="nav-link">SpringCloud</a></li><li class="dropdown-item"><!----> <a href="/pages/957695/" class="nav-link">分布式事务</a></li><li class="dropdown-item"><!----> <a href="/pages/2beec7/" class="nav-link">云存储</a></li><li class="dropdown-item"><!----> <a href="/pages/9eed4b/" aria-current="page" class="nav-link router-link-exact-active router-link-active">搜索引擎</a></li><li class="dropdown-item"><!----> <a href="/pages/9f26dc/" class="nav-link">多媒体框架</a></li><li class="dropdown-item"><!----> <a href="/pages/412fe7/" class="nav-link">虚拟机</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发日常" class="dropdown-title"><!----> <span class="title" style="display:;">开发日常</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/626493/" class="nav-link">开发工具篇</a></li><li class="dropdown-item"><!----> <a href="/pages/bdbd1f/" class="nav-link">工具库篇</a></li><li class="dropdown-item"><!----> <a href="/pages/cc202d/" class="nav-link">开发技巧篇</a></li><li class="dropdown-item"><!----> <a href="/pages/dea09d/" class="nav-link">工具类系列</a></li><li class="dropdown-item"><!----> <a href="/pages/3cd6be/" class="nav-link">随笔</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端学习" class="dropdown-title"><!----> <span class="title" style="display:;">前端学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/3eeffb/" class="nav-link">前端环境搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/99897f/" class="nav-link">HTML与CSS</a></li><li class="dropdown-item"><!----> <a href="/pages/51542d/" class="nav-link">JS学习</a></li><li class="dropdown-item"><!----> <a href="/pages/3c013f/" class="nav-link">Axios入门</a></li><li class="dropdown-item"><!----> <a href="/pages/47c242/" class="nav-link">Vue Router入门</a></li><li class="dropdown-item"><!----> <a href="/pages/51542d/" class="nav-link">Pinia入门</a></li><li class="dropdown-item"><!----> <a href="/pages/803f9d/" class="nav-link">Vue3入门</a></li><li class="dropdown-item"><!----> <a href="/pages/ca4cfb/" class="nav-link">Vue3进阶</a></li><li class="dropdown-item"><!----> <a href="/pages/50e8d3/" class="nav-link">黑马Vue3</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目笔记" class="dropdown-title"><!----> <span class="title" style="display:;">项目笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/ebb9f9/" class="nav-link">脚手架搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/fbc2fc/" class="nav-link">瑞吉外卖</a></li><li class="dropdown-item"><!----> <a href="/pages/ee76ba/" class="nav-link">黑马点评</a></li><li class="dropdown-item"><!----> <a href="/pages/fa01b6/" class="nav-link">vue-blog</a></li><li class="dropdown-item"><!----> <a href="/pages/b363e2/" class="nav-link">沉梦接口开放平台</a></li><li class="dropdown-item"><!----> <a href="/pages/72b962/" class="nav-link">用户中心</a></li><li class="dropdown-item"><!----> <a href="/pages/8baa93/" class="nav-link">聚合搜索平台</a></li><li class="dropdown-item"><!----> <a href="/pages/a6b2f3/" class="nav-link">仿12306项目</a></li><li class="dropdown-item"><!----> <a href="/pages/b85237/" class="nav-link">壁纸小程序项目</a></li><li class="dropdown-item"><!----> <a href="/pages/a2c11e/" class="nav-link">RuoYi-Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它" class="dropdown-title"><!----> <span class="title" style="display:;">其它</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/fa256e/" class="nav-link">博客搭建</a></li><li class="dropdown-item"><!----> <a href="/pages/335531/" class="nav-link">网站收藏箱</a></li><li class="dropdown-item"><!----> <a href="/pages/94109b/" class="nav-link">断墨寻径摘录</a></li><li class="dropdown-item"><!----> <a href="/pages/22f2c8/" class="nav-link">费曼学习法</a></li></ul></div></div> <a href="https://github.com/cmty256" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>API网关</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>RPC</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>消息队列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring Cloud</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>分布式事务</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>云存储</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>搜索引擎</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/9eed4b/" aria-current="page" class="active sidebar-link">Elasticsearch入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/9eed4b/#官方文档" class="sidebar-link">官方文档</a></li><li class="sidebar-sub-header level2"><a href="/pages/9eed4b/#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header level2"><a href="/pages/9eed4b/#全文搜索引擎" class="sidebar-link">全文搜索引擎</a></li><li class="sidebar-sub-header level2"><a href="/pages/9eed4b/#环境准备" class="sidebar-link">环境准备</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#es-安装-linux" class="sidebar-link">ES 安装（Linux）</a></li><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#kibana-安装" class="sidebar-link">Kibana 安装</a></li><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#es-安装-windows" class="sidebar-link">ES 安装（Windows）</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/9eed4b/#正排和倒排索引" class="sidebar-link">正排和倒排索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#正排索引-传统" class="sidebar-link">正排索引（传统）</a></li><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#倒排索引" class="sidebar-link">倒排索引</a></li><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#概念小结" class="sidebar-link">概念小结</a></li><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#优缺点分析" class="sidebar-link">优缺点分析</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/9eed4b/#elasticsearch-vs-mysql" class="sidebar-link">Elasticsearch vs MySQL</a></li><li class="sidebar-sub-header level2"><a href="/pages/9eed4b/#dsl-语法" class="sidebar-link">DSL 语法</a></li><li class="sidebar-sub-header level2"><a href="/pages/9eed4b/#ik-分词器" class="sidebar-link">IK 分词器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#使用" class="sidebar-link">使用</a></li><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#拓展词典" class="sidebar-link">拓展词典</a></li><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#总结" class="sidebar-link">总结</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/9eed4b/#mapping-映射属性" class="sidebar-link">Mapping 映射属性</a></li><li class="sidebar-sub-header level2"><a href="/pages/9eed4b/#索引库操作" class="sidebar-link">索引库操作</a></li><li class="sidebar-sub-header level2"><a href="/pages/9eed4b/#文档操作" class="sidebar-link">文档操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#crud" class="sidebar-link">CRUD</a></li><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#批处理" class="sidebar-link">批处理</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/9eed4b/#restapi" class="sidebar-link">RestAPI</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#索引" class="sidebar-link">索引</a></li><li class="sidebar-sub-header level3"><a href="/pages/9eed4b/#文档" class="sidebar-link">文档</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/9eed4b/#学习参考" class="sidebar-link">学习参考</a></li></ul></li><li><a href="/pages/ec50b4/" class="sidebar-link">Elasticsearch之DSL篇</a></li><li><a href="/pages/7979d7/" class="sidebar-link">Elasticsearch之HTTP篇</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>多媒体框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>虚拟机</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>微服务</span></li><li data-v-06225672><span data-v-06225672>搜索引擎</span></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/cmty256" target="_blank" title="作者" class="beLink" data-v-06225672>沉梦听雨</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-09-07</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Elasticsearch入门<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="elasticsearch-入门"><a href="#elasticsearch-入门" class="header-anchor">#</a> Elasticsearch 入门</h1> <h2 id="官方文档"><a href="#官方文档" class="header-anchor">#</a> 官方文档</h2> <ul><li><p>官方地址：<a href="https://www.elastic.co/cn/" target="_blank" rel="noopener noreferrer">Elastic — 搜索 AI 公司 | Elastic<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>ES 下载地址：<a href="https://www.elastic.co/cn/downloads/past-releases#elasticsearch" target="_blank" rel="noopener noreferrer">Past Releases of Elastic Stack Software | Elastic<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>文档：<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.17/elasticsearch-intro.html" target="_blank" rel="noopener noreferrer">什么是 Elasticsearch？|Elasticsearch 指南<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul> <h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <blockquote><p>Elasticsearch 是一个分布式、RESTful 风格的搜索和数据分析引擎，能够解决不断涌现出的各种用例。作为 Elastic Stck 的核心，它集中存储您的数据，帮助您发现意料之中以及意料之外的情况。</p></blockquote> <p>The Elastic Stack，包括 Elasticsearch、Kibana、Beats 和 Logstash(也称为ELK Stack)。能够安全可靠地获取任何来源、任何格式的数据，然后实时地对数据进行搜索、分析和可视化。经常用来做日志收集、系统监控和状态分析等等。</p> <ul><li>Elasticsearch：用于数据存储、计算和搜索</li> <li>Logstash/Beats：用于数据收集</li> <li>Kibana：用于数据可视化</li></ul> <p>Elaticsearch，简称为 ES，ES 是一个<strong>开源的高扩展的分布式全文搜索引擎</strong>，是整个 Elastic Sack 技术栈的核心。它可以近乎实时的存储、检索数据；本身扩展性很好，可以扩展到上百台服务器，处理 PB 级别的数据。</p> <p><strong>搜索引擎技术排名</strong>：</p> <ul><li>Elasticsearch：开源的分布式搜索引擎</li> <li>Splunk：商业项目</li> <li>Solr：Apache 的开源搜索引擎</li></ul> <h2 id="全文搜索引擎"><a href="#全文搜索引擎" class="header-anchor">#</a> 全文搜索引擎</h2> <p>Google，百度类的网站搜索，它们都是根据网页中的关键字生成索引，我们在搜索的时候输入关键字，它们会将该关键字即索引匹配到的所有网页返回；还有常见的项目中应用日志的搜索等等。对于这些非结构化的数据文本，关系型数据库搜索不是能很好的支持。</p> <p>一般传统数据库，全文检索都实现的很鸡肋，因为一般也没人用数据库存文本字段。进行全文检索需要扫描整个表，如果数据量大的话即使对 SQL 的语法优化，也收效甚微。建立了索引，但是维护起来也很麻烦，对于 insert 和 update 操作都会重新构建索引。</p> <p>基于以上原因可以分析得出，在一些生产环境中，使用常规的搜索方式，性能是非常差的：</p> <ul><li>搜索的数据对象是大量的非结构化的文本数据。</li> <li>文件记录量达到数十万或数百万个甚至更多。</li> <li>支持大量基于交互式文本的查询。</li> <li>需求非常灵活的全文搜索查询。</li> <li>对高度相关的搜索结果的有特殊需求，但是没有可用的关系数据库可以满足。</li> <li>对不同记录类型、非文本数据操作或安全事务处理的需求相对较少的情况。</li></ul> <p>为了解决结构化数据搜索和非结构化数据搜索性能问题，我们就需要专业，健壮，强大的全
文搜索引擎</p> <blockquote><p>这里说到的全文搜索引擎指的是目前广泛应用的主流搜索引擎。</p> <p>它的工作原理是计算机索引程序通过扫描文章中的每一个词，对每一个词建立一个索引，指明该词在文章中出现的次数和位置，当用户查询时，检索程序就根据事先建立的索引进行查找，并将查找的结果反馈给用户的检索方式。</p> <p>这个过程类似于通过字典中的检索字表查字的过程。</p></blockquote> <h2 id="环境准备"><a href="#环境准备" class="header-anchor">#</a> 环境准备</h2> <h3 id="es-安装-linux"><a href="#es-安装-linux" class="header-anchor">#</a> ES 安装（Linux）</h3> <p>通过下面的 Docker 命令即可安装单机版本的 elasticsearch：</p> <ul><li>安装完成后，访问 9200 端口，即可看到响应的 Elasticsearch 服务的基本信息</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--name</span> es <span class="token punctuation">\</span>
  <span class="token parameter variable">-e</span> <span class="token string">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-e</span> <span class="token string">&quot;discovery.type=single-node&quot;</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> es-data:/usr/share/elasticsearch/data <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> es-plugins:/usr/share/elasticsearch/plugins <span class="token punctuation">\</span>
  <span class="token parameter variable">--privileged</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-p</span> <span class="token number">9200</span>:9200 <span class="token punctuation">\</span>
  <span class="token parameter variable">-p</span> <span class="token number">9300</span>:9300 <span class="token punctuation">\</span>
  elasticsearch:7.12.1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="kibana-安装"><a href="#kibana-安装" class="header-anchor">#</a> Kibana 安装</h3> <p>通过下面的 Docker 命令，即可部署 Kibana：</p> <ul><li>安装完成后，直接访问 5601 端口，即可看到控制台页面：</li> <li>选择 <code>Explore on my own</code> 之后，进入主页面</li> <li>然后选中 <code>Dev tools</code>，进入开发工具页面</li> <li></li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 这里配置的 [服务器ip] 地址，可以改写成 es，前提是需要设置 --network 属性，将 es 和 kibana she'z</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--name</span> kibana <span class="token punctuation">\</span>
  <span class="token parameter variable">-e</span> <span class="token assign-left variable">ELASTICSEARCH_HOSTS</span><span class="token operator">=</span>http://<span class="token punctuation">[</span>服务器ip<span class="token punctuation">]</span>:9200 <span class="token punctuation">\</span>
  <span class="token parameter variable">-p</span> <span class="token number">5601</span>:5601  <span class="token punctuation">\</span>
  kibana:7.12.1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>图解：</p> <ul><li>这里就没有必要再加上 es 的地址了，因为 kibana 已经知道 es 的地址了（在创建kibana容器时就知道了）。所以这里的地址就可以用 <code>/</code> 代替</li></ul> <p><img alt="image" data-src="https://cmty256.github.io/picx-images-hosting/microservice/image.6f0vs37g75.jpg" loading="lazy" class="lazy"></p> <h3 id="es-安装-windows"><a href="#es-安装-windows" class="header-anchor">#</a> ES 安装（Windows）</h3> <p>Windows 版的 Elasticsearch 压缩包，解压即安装完毕，解压后的 Elasticsearch 的目录结构如下 ：</p> <ul><li>解压后，进入 <code>bin</code> 文件目录，点击 <code>elasticsearch.bat</code> 文件启动 ES 服务。</li></ul> <table><thead><tr><th>目录</th> <th>含义</th></tr></thead> <tbody><tr><td>bin</td> <td>可执行脚本目录</td></tr> <tr><td>config</td> <td>配置目录</td></tr> <tr><td>jdk</td> <td>内置 JDK 目录</td></tr> <tr><td>lib</td> <td>类库</td></tr> <tr><td>logs</td> <td>日志目录</td></tr> <tr><td>modules</td> <td>模块目录</td></tr> <tr><td>plugins</td> <td>插件目录</td></tr></tbody></table> <p>注意：</p> <ul><li>9300 端口为 Elasticsearch 集群间组件的通信端口，</li> <li>9200 端口为浏览器访问的 http 协议 RESTful 端口。</li></ul> <p>打开浏览器，输入地址：<a href="http://localhost:9200" target="_blank" rel="noopener noreferrer">http://localhost:9200<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，测试返回结果，返回结果如下：</p> <ul><li>正常有返回结果即可</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CHENMENG&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;cluster_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;elasticsearch&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;cluster_uuid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;kzJynYXKQge03U7WpEu8fg&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;number&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7.8.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build_flavor&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zip&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build_hash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;757314695644ea9a1dc2fecd26d1a43856725e65&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build_date&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2020-06-14T19:35:50.234439Z&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build_snapshot&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lucene_version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8.5.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;minimum_wire_compatibility_version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;6.8.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;minimum_index_compatibility_version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;6.0.0-beta1&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;tagline&quot;</span><span class="token operator">:</span> <span class="token string">&quot;You Know, for Search&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="正排和倒排索引"><a href="#正排和倒排索引" class="header-anchor">#</a> 正排和倒排索引</h2> <p>elasticsearch 之所以有如此高性能的搜索表现，正是得益于底层的倒排索引技术。</p> <h3 id="正排索引-传统"><a href="#正排索引-传统" class="header-anchor">#</a> 正排索引（传统）</h3> <table><thead><tr><th>id（索引）</th> <th>content</th></tr></thead> <tbody><tr><td>1001</td> <td>my name is zhang san</td></tr> <tr><td>1002</td> <td>my name is li si</td></tr></tbody></table> <h3 id="倒排索引"><a href="#倒排索引" class="header-anchor">#</a> 倒排索引</h3> <p>倒排索引中有两个非常重要的概念：</p> <ul><li>文档（<code>Document</code>）：用来搜索的数据，其中的每一条数据就是一个文档。例如一个网页、一个商品信息</li> <li>词条（<code>Term</code>）：对文档数据或用户搜索数据，利用某种算法分词，得到的具备含义的词语就是词条。例如：我是中国人，就可以分为：我、是、中国人、中国、国人这样的几个词条</li></ul> <p><strong>创建倒排索引</strong>是对正向索引的一种特殊处理和应用，流程如下：</p> <ul><li>将每一个文档的数据利用<strong>分词算法</strong>根据语义拆分，得到一个个词条</li> <li>创建表，每行数据包括词条、词条所在文档id、位置等信息</li> <li>因为词条唯一性，可以给词条创建<strong>正向</strong>索引</li></ul> <table><thead><tr><th>Term 词条（索引）</th> <th>文档 id</th></tr></thead> <tbody><tr><td>name</td> <td>1001,1002</td></tr> <tr><td>zhang</td> <td>1001</td></tr></tbody></table> <h3 id="概念小结"><a href="#概念小结" class="header-anchor">#</a> 概念小结</h3> <ul><li><strong>正排索引</strong>是最传统的，根据 id 索引的方式。但根据词条查询时，必须先逐条获取每个文档，然后判断文档中是否包含所需要的词条，是<strong>根据文档找词条的过程</strong>。</li> <li>而<strong>倒排索引</strong>则相反，是先找到用户要搜索的词条，根据词条得到保护词条的文档的 id，然后根据 id 获取文档。是<strong>根据词条找文档的过程</strong>。</li></ul> <h3 id="优缺点分析"><a href="#优缺点分析" class="header-anchor">#</a> 优缺点分析</h3> <blockquote><p>正排索引</p></blockquote> <ul><li><strong>优点</strong>：
<ul><li>可以给多个字段创建索引</li> <li>根据索引字段搜索、排序速度非常快</li></ul></li> <li><strong>缺点</strong>：
<ul><li>根据非索引字段，或者索引字段中的部分词条查找时，只能全表扫描。</li></ul></li></ul> <blockquote><p>倒排索引</p></blockquote> <ul><li><strong>优点</strong>：
<ul><li>根据词条搜索、模糊搜索时，速度非常快</li></ul></li> <li><strong>缺点</strong>：
<ul><li>只能给词条创建索引，而不是字段</li> <li>无法根据字段做排序</li></ul></li></ul> <h2 id="elasticsearch-vs-mysql"><a href="#elasticsearch-vs-mysql" class="header-anchor">#</a> Elasticsearch vs MySQL</h2> <p>Elasticsearch 是面向文档型数据库，一条数据在这里就是一个文档。</p> <p>为了方便大家理解，我们将 Elasticsearch 里存储文档数据和关系型数据库 MySQL 存储数据的概念进行一个类比：</p> <table><thead><tr><th>Elasticsearch</th> <th>MySQL</th> <th>说明</th></tr></thead> <tbody><tr><td>Cluster</td> <td>多个数据库实例</td> <td>整个 Elasticsearch 集群（多个节点）</td></tr> <tr><td>索引 Index</td> <td>✅ 更像 Table</td> <td>文档的集合，一个索引相当于一个“表”</td></tr> <tr><td>Type（<strong>已废弃</strong>）</td> <td>表（Table）</td> <td>旧版本中的 Type 类似于 MySQL 中的表，但 7.x+ 已废弃</td></tr> <tr><td>文档 Document</td> <td>行（Row）</td> <td>就是一条条的数据，类似数据库中的行（Row），文档都是 JSON 格式</td></tr> <tr><td>字段 Field</td> <td>列（Column）</td> <td>每个文档中的属性，就是 JSON 文档中的字段，类似数据库中的列</td></tr> <tr><td>映射 Mapping</td> <td>表结构（Schema）</td> <td>定义字段类型和结构，是索引中文档的约束，例如字段类型约束。类似数据库的表结构</td></tr> <tr><td>DSL</td> <td>SQL</td> <td>DSL 是 ES 提供的 JSON 风格的请求语句，用来操作 ES，实现 CRUD</td></tr> <tr><td>Shard</td> <td>分片机制</td> <td>类似分库分表中的分片概念</td></tr> <tr><td>Replica</td> <td>主从复制</td> <td>高可用副本机制</td></tr></tbody></table> <blockquote><p>对比分析：</p></blockquote> <ul><li>Mysql：擅长事务类型操作，可以确保数据的安全和一致性</li> <li>Elasticsearch：擅长海量数据的搜索、分析、计算</li></ul> <blockquote><p>因此，在企业中，往往是两者结合使用：</p></blockquote> <ul><li>对安全性要求较高的写操作，使用 mysql 实现</li> <li>对查询性能要求较高的搜索需求，使用 elasticsearch 实现</li> <li>两者再基于某种方式，实现数据的同步，保证一致性</li></ul> <h2 id="dsl-语法"><a href="#dsl-语法" class="header-anchor">#</a> DSL 语法</h2> <ul><li><p>json 格式，好理解，和 http 请求最兼容，应用最广</p></li> <li><p>官方文档：</p> <ul><li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.17/query-dsl.html" target="_blank" rel="noopener noreferrer">Query DSL | Elasticsearch Guide | Elastic<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.12/query-dsl.html" target="_blank" rel="noopener noreferrer">Query DSL | 7.12.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul> <h2 id="ik-分词器"><a href="#ik-分词器" class="header-anchor">#</a> IK 分词器</h2> <p>Elasticsearch 的关键就是倒排索引，而倒排索引依赖于对文档内容的分词，而分词则需要高效、精准的分词算法，IK 分词器就是这样一个中文分词算法。</p> <h3 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h3> <blockquote><p>1、在线安装</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 命令行在线安装（地址对应官网）</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> es ./bin/elasticsearch-plugin  <span class="token function">install</span> https://release.infinilabs.com/analysis-ik/stable/elasticsearch-analysis-ik-7.12.1.zip

<span class="token comment"># 重启 es 容器</span>
<span class="token function">docker</span> restart es
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>2、离线安装</p></blockquote> <p>如果网速较差，也可以选择离线安装。</p> <p>（1）首先，查看之前安装的 Elasticsearch 容器的 plugins 数据卷目录：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> volume inspect es-plugins
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（2）然后，需要把本地的 IK分词器文件夹 上传至这个目录。（官网下载压缩包，放到 Linux 环境下再解压，Windows 下解压的话会丢失文件）</p> <p>（3）最后，重启 es 容器</p> <h3 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h3> <p>IK 分词器包含<strong>两种模式</strong>：</p> <ul><li><p><code>ik_smart</code>：智能语义切分</p></li> <li><p><code>ik_max_word</code>：最细粒度切分</p></li></ul> <p>我们在 Kibana 的 DevTools 上来测试分词器，首先测试 Elasticsearch 官方提供的<strong>标准分词器</strong>：</p> <div class="language-JSON line-numbers-mode"><pre class="language-json"><code>POST /_analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;这是分词器测试示例&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>结果分析：</p> <ul><li>标准分词器智能 1 字 1 词条，无法正确对中文做分词。</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;tokens&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;token&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;我&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;start_offset&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;end_offset&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;CN_CHAR&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;position&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;token&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;爱&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;start_offset&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;end_offset&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;CN_CHAR&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;position&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;token&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;技术&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;start_offset&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">&quot;end_offset&quot;</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;CN_WORD&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;position&quot;</span> <span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>我们再测试 <strong>IK 分词器</strong>：</p> <div class="language-JSON line-numbers-mode"><pre class="language-json"><code>POST /_analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ik_smart&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;这是分词器测试示例&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>结果分析：</p> <ul><li>会根据中文语义智能分词</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;tokens&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;token&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;这是&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;start_offset&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;end_offset&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;CN_WORD&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;position&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;token&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;分词器&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;start_offset&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">&quot;end_offset&quot;</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;CN_WORD&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;position&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;token&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;测试&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;start_offset&quot;</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      <span class="token property">&quot;end_offset&quot;</span> <span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
      <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;CN_WORD&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;position&quot;</span> <span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;token&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;示例&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;start_offset&quot;</span> <span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
      <span class="token property">&quot;end_offset&quot;</span> <span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
      <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;CN_WORD&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;position&quot;</span> <span class="token operator">:</span> <span class="token number">3</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="拓展词典"><a href="#拓展词典" class="header-anchor">#</a> 拓展词典</h3> <p>随着互联网的发展，“造词运动” 也越发的频繁。出现了很多新的词语，在原有的词汇列表中并不存在。比如：“泰裤辣”，“传智播客” 等。</p> <ul><li>IK 分词器无法对这些词汇分词</li> <li>所以要想正确分词，IK 分词器的<strong>词库</strong>也需要不断的更新，IK 分词器提供了扩展词汇的功能</li></ul> <p><strong>添加自定义词典</strong>步骤如下：</p> <ol><li>打开 IK 分词器 config 目录：</li> <li>在 <code>IKAnalyzer.cfg.xml</code> 配置文件内容添加：</li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">properties</span> <span class="token name">SYSTEM</span> <span class="token string">&quot;http://java.sun.com/dtd/properties.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>comment</span><span class="token punctuation">&gt;</span></span>IK Analyzer 扩展配置<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>comment</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--用户可以在这里配置自己的扩展字典 *** 添加扩展词典--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ext_dict<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>ext.dic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="3"><li>在 IK 分词器的 config 目录新建一个 <code>ext.dic</code>，可以参考 config 目录下复制一个配置文件进行修改：</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>传智播客
泰裤辣
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="4"><li>重启 elasticsearch</li></ol> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> restart es

<span class="token comment"># 查看 日志</span>
<span class="token function">docker</span> logs <span class="token parameter variable">-f</span> elasticsearch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <blockquote><p>分词器的作用是什么？</p></blockquote> <ul><li>创建倒排索引时，对文档分词</li> <li>用户搜索时，对输入的内容分词</li></ul> <blockquote><p>IK 分词器有几种模式？</p></blockquote> <ul><li><code>ik_smart</code>：智能切分，粗粒度</li> <li><code>ik_max_word</code>：最细切分，细粒度</li></ul> <blockquote><p>IK 分词器如何拓展词条？如何停用词条？</p></blockquote> <ul><li>利用 config 目录的 <code>IkAnalyzer.cfg.xml</code> 文件添加拓展词典和停用词典</li> <li>在词典中添加拓展词条或者停用词条</li></ul> <h2 id="mapping-映射属性"><a href="#mapping-映射属性" class="header-anchor">#</a> Mapping 映射属性</h2> <p>Mapping 是对索引库中文档的约束，常见的 Mapping 属性包括：</p> <ul><li><code>type</code>：字段数据类型，常见的简单类型有：
<ul><li>字符串：<code>text</code>（可分词的文本）、<code>keyword</code>（精确值，例如：品牌、国家、ip地址）</li> <li>数值：<code>long</code>、<code>integer</code>、<code>short</code>、<code>byte</code>、<code>double</code>、<code>float</code>、</li> <li>布尔：<code>boolean</code></li> <li>日期：<code>date</code></li> <li>对象：<code>object</code></li></ul></li> <li><code>index</code>：是否创建索引，默认为 <code>true</code></li> <li><code>analyzer</code>：使用哪种分词器</li> <li><code>properties</code>：该字段的子字段</li></ul> <p>例如下面的 json 文档：</p> <div class="language-JSON line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">,</span>
    <span class="token property">&quot;weight&quot;</span><span class="token operator">:</span> <span class="token number">52.1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;isMarried&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;info&quot;</span><span class="token operator">:</span> <span class="token string">&quot;沉梦听雨学 Elasticsearch&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zy@itcast.cn&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;score&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">99.1</span><span class="token punctuation">,</span> <span class="token number">99.5</span><span class="token punctuation">,</span> <span class="token number">98.9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;firstName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;云&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;lastName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;赵&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>对应的每个字段映射（Mapping）：</p> <table><thead><tr><th style="text-align:left;"><strong>字段名</strong></th> <th style="text-align:left;"><strong>字段类型</strong></th> <th style="text-align:left;"><strong>类型说明</strong></th> <th style="text-align:left;"><strong>是否参与搜索</strong></th> <th style="text-align:left;"><strong>是否参与分词</strong></th> <th style="text-align:left;"><strong>分词器</strong></th></tr></thead> <tbody><tr><td style="text-align:left;">age</td> <td style="text-align:left;"><code>integer</code></td> <td style="text-align:left;">整数</td> <td style="text-align:left;">✅</td> <td style="text-align:left;"></td> <td style="text-align:left;">——</td></tr> <tr><td style="text-align:left;">weight</td> <td style="text-align:left;"><code>float</code></td> <td style="text-align:left;">浮点数</td> <td style="text-align:left;">✅</td> <td style="text-align:left;"></td> <td style="text-align:left;">——</td></tr> <tr><td style="text-align:left;">isMarried</td> <td style="text-align:left;"><code>boolean</code></td> <td style="text-align:left;">布尔</td> <td style="text-align:left;">✅</td> <td style="text-align:left;"></td> <td style="text-align:left;">——</td></tr> <tr><td style="text-align:left;">info</td> <td style="text-align:left;"><code>text</code></td> <td style="text-align:left;">字符串，但需要分词</td> <td style="text-align:left;">✅</td> <td style="text-align:left;">✅</td> <td style="text-align:left;">IK</td></tr> <tr><td style="text-align:left;">email</td> <td style="text-align:left;"><code>keyword</code></td> <td style="text-align:left;">字符串，但是不分词</td> <td style="text-align:left;"></td> <td style="text-align:left;"></td> <td style="text-align:left;">——</td></tr> <tr><td style="text-align:left;">score</td> <td style="text-align:left;"><code>float</code></td> <td style="text-align:left;">只看数组中元素类型</td> <td style="text-align:left;">✅</td> <td style="text-align:left;"></td> <td style="text-align:left;">——</td></tr> <tr><td style="text-align:left;">（name）firstName</td> <td style="text-align:left;"><code>keyword</code></td> <td style="text-align:left;">字符串，但是不分词</td> <td style="text-align:left;">✅</td> <td style="text-align:left;"></td> <td style="text-align:left;">——</td></tr> <tr><td style="text-align:left;">（name）lastName</td> <td style="text-align:left;"><code>keyword</code></td> <td style="text-align:left;">字符串，但是不分词</td> <td style="text-align:left;">✅</td> <td style="text-align:left;"></td> <td style="text-align:left;">——</td></tr></tbody></table> <h2 id="索引库操作"><a href="#索引库操作" class="header-anchor">#</a> 索引库操作</h2> <ul><li>创建索引库：<code>PUT /索引库名</code></li> <li>查询索引库：<code>GET /索引库名</code></li> <li>删除索引库：<code>DELETE /索引库名</code></li> <li>修改索引库，添加字段：<code>PUT /索引库名/_mapping</code></li></ul> <h2 id="文档操作"><a href="#文档操作" class="header-anchor">#</a> 文档操作</h2> <h3 id="crud"><a href="#crud" class="header-anchor">#</a> CRUD</h3> <ul><li>创建文档：<code>POST /{索引库名}/_doc/文档id { json文档 }</code></li> <li>查询文档：<code>GET /{索引库名}/_doc/文档id</code></li> <li>删除文档：<code>DELETE /{索引库名}/_doc/文档id</code></li> <li>修改文档：
<ul><li>全量修改：<code>PUT /{索引库名}/_doc/文档id { json文档 }</code></li> <li>局部修改：<code>POST /{索引库名}/_update/文档id { &quot;doc&quot;: {字段}}</code></li></ul></li></ul> <h3 id="批处理"><a href="#批处理" class="header-anchor">#</a> 批处理</h3> <blockquote><p>语法</p></blockquote> <p>批处理采用 <code>POST</code> 请求，基本语法如下：</p> <div class="language-Java line-numbers-mode"><pre class="language-java"><code><span class="token constant">POST</span> _bulk
<span class="token punctuation">{</span><span class="token string">&quot;index&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;field1&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;value1&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;delete&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;create&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;3&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;field1&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;value3&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;update&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;doc&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">&quot;field2&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;value2&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>操作类型分析</p></blockquote> <table><thead><tr><th>操作类型</th> <th>幂等性</th> <th>文档存在性处理</th> <th>数据变更方式</th> <th>典型场景</th></tr></thead> <tbody><tr><td><code>index</code></td> <td>否</td> <td>存在则覆盖，不存在则创建</td> <td>全量替换</td> <td>数据覆盖、不确定存在性</td></tr> <tr><td><code>create</code></td> <td>否</td> <td>仅当不存在时创建，存在则冲突</td> <td>新增</td> <td>强制唯一性写入</td></tr> <tr><td><code>update</code></td> <td>否</td> <td>必须存在（除非用 <code>upsert</code>）</td> <td>部分更新/脚本修改</td> <td>增量更新、条件逻辑更新</td></tr> <tr><td><code>delete</code></td> <td>是</td> <td>存在则删除，不存在也视为成功</td> <td>删除</td> <td>清理数据</td></tr></tbody></table> <blockquote><p>常见误区纠正</p></blockquote> <ol><li><strong><code>index</code> 不是单纯的“新增”</strong>：
<ul><li>它是 “创建或全量替换”，与 <code>create</code> 的 “仅创建” 有本质区别。</li></ul></li> <li><strong><code>update</code> 不支持新增字段？</strong>：
<ul><li><code>update</code> 的 <code>doc</code> 中可以包含新字段，Elasticsearch 会自动合并到文档中。</li></ul></li> <li><strong>批量操作中的 HTTP 方法</strong>：
<ul><li><code>_bulk</code> API 必须使用 <code>POST</code> 请求，且请求体格式严格依赖换行符分隔 JSON。</li></ul></li> <li><strong>操作顺序与原子性</strong>：
<ul><li>批量操作中的每个动作独立执行，无事务保证。部分操作失败不影响其他操作。</li></ul></li></ol> <blockquote><p>示例</p></blockquote> <p>批量新增：</p> <div class="language-Java line-numbers-mode"><pre class="language-java"><code><span class="token constant">POST</span> <span class="token operator">/</span>_bulk
<span class="token punctuation">{</span><span class="token string">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token operator">:</span><span class="token string">&quot;heima&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;info&quot;</span><span class="token operator">:</span> <span class="token string">&quot;黑马程序员C++讲师&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ww@itcast.cn&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">&quot;firstName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;五&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;lastName&quot;</span><span class="token operator">:</span><span class="token string">&quot;王&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token operator">:</span><span class="token string">&quot;heima&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;info&quot;</span><span class="token operator">:</span> <span class="token string">&quot;黑马程序员前端讲师&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zhangsan@itcast.cn&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">&quot;firstName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;三&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;lastName&quot;</span><span class="token operator">:</span><span class="token string">&quot;张&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>批量删除：</p> <div class="language-Java line-numbers-mode"><pre class="language-java"><code><span class="token constant">POST</span> <span class="token operator">/</span>_bulk
<span class="token punctuation">{</span><span class="token string">&quot;delete&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token operator">:</span><span class="token string">&quot;heima&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;delete&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token operator">:</span><span class="token string">&quot;heima&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="restapi"><a href="#restapi" class="header-anchor">#</a> RestAPI</h2> <ul><li>ES 官方提供了各种不同语言的客户端，用来操作 ES。</li> <li>这些客户端的本质就是组装 DSL 语句，通过 http 请求发送给 ES。</li> <li>官方文档地址：
<ul><li>新版：<a href="https://www.elastic.co/guide/en/elasticsearch/client/index.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/client/index.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>旧版：<a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/7.12/java-rest-high-getting-started-maven.html" target="_blank" rel="noopener noreferrer">Maven 存储库 |Java REST 客户端 7.12 <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul> <h3 id="索引"><a href="#索引" class="header-anchor">#</a> 索引</h3> <p><code>JavaRestClient</code> 操作 elasticsearch 的流程基本类似。核心是 <code>client.indices()</code> 方法来获取索引库的操作对象。</p> <p><strong>索引库操作</strong>的基本步骤：</p> <ul><li>初始化 <code>RestHighLevelClient</code></li> <li>创建 XxxIndexRequest。
<ul><li>XXX 是 <code>Create</code>、<code>Get</code>、<code>Delete</code></li></ul></li> <li>准备请求参数（<code>Create</code> 时需要，其它是无参，可以省略）</li> <li>发送请求。调用 <code>RestHighLevelClient#indices().xxx()</code> 方法，xxx 是 <code>create</code>、<code>exists</code>、<code>delete</code></li></ul> <p>代码示例：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IndexTest</span> <span class="token punctuation">{</span>

    <span class="token class-name">String</span> <span class="token constant">ES_URL</span> <span class="token operator">=</span> <span class="token string">&quot;http://192.168.207.129:9200&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">RestHighLevelClient</span> client<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@BeforeEach</span>
    <span class="token keyword">void</span> <span class="token function">setUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span><span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span>
                <span class="token class-name">HttpHost</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">ES_URL</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;setUp success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">testConnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">testCreateIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1.创建Request对象</span>
        <span class="token class-name">CreateIndexRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CreateIndexRequest</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.准备请求参数</span>
        request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token constant">MAPPING_TEMPLATE</span><span class="token punctuation">,</span> <span class="token class-name">XContentType</span><span class="token punctuation">.</span><span class="token constant">JSON</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3.发送请求</span>
        client<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">testDeleteIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1.创建Request对象</span>
        <span class="token class-name">DeleteIndexRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeleteIndexRequest</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.发送请求</span>
        <span class="token class-name">AcknowledgedResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">isAcknowledged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">testGetIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1.创建Request对象</span>
        <span class="token class-name">GetIndexRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GetIndexRequest</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.发送请求</span>
        <span class="token class-name">GetIndexResponse</span> getIndexResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3.输出</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>getIndexResponse<span class="token punctuation">.</span><span class="token function">getAliases</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>getIndexResponse<span class="token punctuation">.</span><span class="token function">getMappings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>getIndexResponse<span class="token punctuation">.</span><span class="token function">getSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">testExistsIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1.创建Request对象</span>
        <span class="token class-name">GetIndexRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GetIndexRequest</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.发送请求</span>
        <span class="token keyword">boolean</span> exists <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3.输出</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>exists <span class="token operator">?</span> <span class="token string">&quot;索引库已经存在！&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;索引库不存在！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">MAPPING_TEMPLATE</span> <span class="token operator">=</span> <span class="token string">&quot;{\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;  \&quot;mappings\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;    \&quot;properties\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;id\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;long\&quot;\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;user_account\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;keyword\&quot;\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;user_password\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;keyword\&quot;,\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;index\&quot;: false\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;user_name\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;text\&quot;,\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;analyzer\&quot;: \&quot;ik_max_word\&quot;,\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;fields\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;          \&quot;keyword\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;            \&quot;type\&quot;: \&quot;keyword\&quot;,\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;            \&quot;ignore_above\&quot;: 256\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;          }\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        }\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;user_avatar\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;keyword\&quot;,\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;index\&quot;: false\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;gender\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;integer\&quot;\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;phone\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;keyword\&quot;\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;email\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;keyword\&quot;\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;user_profile\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;text\&quot;,\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;analyzer\&quot;: \&quot;ik_max_word\&quot;\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;user_role\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;keyword\&quot;\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;create_user\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;long\&quot;\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;create_time\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;date\&quot;,\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;format\&quot;: \&quot;yyyy-MM-dd HH:mm:ss||epoch_millis\&quot;\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;update_user\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;long\&quot;\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;update_time\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;date\&quot;,\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;format\&quot;: \&quot;yyyy-MM-dd HH:mm:ss||epoch_millis\&quot;\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;is_deleted\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;byte\&quot;\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      },\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      \&quot;tenant_id\&quot;: {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;type\&quot;: \&quot;long\&quot;\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;      }\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;    }\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;  }\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;}&quot;</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@AfterEach</span>
    <span class="token keyword">void</span> <span class="token function">tearDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;tearDown success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br></div></div><p><strong>映射属性解释</strong>：</p> <blockquote><p>用户名字段的多字段（multi-field）配置</p></blockquote> <ol><li><strong>主字段配置</strong>：
<ul><li><code>&quot;type&quot;: &quot;text&quot;</code>：表示这是一个全文检索字段，会被分词处理</li> <li><code>&quot;analyzer&quot;: &quot;ik_max_word&quot;</code>：指定使用IK分词器的<code>ik_max_word</code>模式，这种模式会做最细粒度的拆分（适合中文搜索）</li></ul></li> <li><strong>子字段配置</strong>：
<ul><li><code>fields</code> 属性定义了多字段映射，允许同一个字段以不同方式索引</li> <li>keyword 子字段：
<ul><li><code>&quot;type&quot;: &quot;keyword&quot;</code>：表示这是一个关键字字段，不会被分词，用于精确匹配</li> <li><code>&quot;ignore_above&quot;: 256</code>：超过256个字符的字段值不会被索引或存储</li></ul></li></ul></li></ol> <p><strong>使用场景</strong>：</p> <ul><li>搜索&quot;张三&quot;时，使用主字段 <code>user_name</code>（支持分词搜索）</li> <li>精确匹配或聚合时，使用 <code>user_name.keyword</code> 字段</li> <li>例如：<code>GET /user/_search { &quot;query&quot;: { &quot;term&quot;: { &quot;user_name.keyword&quot;: &quot;张三&quot; } } }</code></li></ul> <blockquote><p>日期字段的格式配置</p> <ul><li><code>&quot;format&quot;: &quot;yyyy-MM-dd HH:mm:ss||epoch_millis&quot;</code></li></ul></blockquote> <ol><li><strong>日期格式定义</strong>：
<ul><li><code>yyyy-MM-dd HH:mm:ss</code>：表示接受 &quot;2023-01-01 12:00:00&quot; 这样的字符串格式</li> <li><code>epoch_millis</code>：表示接受时间戳格式（从1970-01-01开始的毫秒数）</li></ul></li> <li><strong>双竖线 <code>||</code></strong>：
<ul><li>表示&quot;或&quot;的关系，即字段可以接受多种格式的日期值</li> <li>这是一个格式列表分隔符，Elasticsearch 会尝试从左到右依次匹配</li></ul></li></ol> <p><strong>使用场景</strong>：</p> <ul><li>可以插入格式化的日期字符串：<code>&quot;2023-01-01 12:00:00&quot;</code></li> <li>也可以插入时间戳：<code>1672560000000</code></li> <li>Elasticsearch 内部会统一存储为 UTC 时间，但查询时可以按原始格式检索</li></ul> <h3 id="文档"><a href="#文档" class="header-anchor">#</a> 文档</h3> <p><strong>文档操作</strong>的基本步骤：</p> <ul><li>初始化 <code>RestHighLevelClient</code></li> <li>创建 XxxRequest。
<ul><li>XXX 是 <code>Index</code>、<code>Get</code>、<code>Update</code>、<code>Delete</code>、<code>Bulk</code></li></ul></li> <li>准备参数（<code>Index</code>、<code>Update</code>、<code>Bulk</code>时需要）</li> <li>发送请求。
<ul><li>调用<code>RestHighLevelClient#.xxx()</code>方法，xxx是<code>index</code>、<code>get</code>、<code>update</code>、<code>delete</code>、<code>bulk</code></li></ul></li> <li>解析结果（<code>Get</code>时需要）</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DocumentTest</span> <span class="token punctuation">{</span>

    <span class="token class-name">String</span> <span class="token constant">ES_URL</span> <span class="token operator">=</span> <span class="token string">&quot;http://192.168.207.129:9200&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">RestHighLevelClient</span> client<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@BeforeEach</span>
    <span class="token keyword">void</span> <span class="token function">setUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span><span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span>
                <span class="token class-name">HttpHost</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">ES_URL</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;setUp success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">testInsertDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1.准备Request对象</span>
        <span class="token class-name">IndexRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.准备Json文档，向ES插入数据，必须将数据转换位JSON格式</span>
        <span class="token class-name">UserDoc</span> userDoc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserDoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userDoc<span class="token punctuation">.</span><span class="token function">setUserName</span><span class="token punctuation">(</span><span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userDoc<span class="token punctuation">.</span><span class="token function">setGender</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toJsonStr</span><span class="token punctuation">(</span>userDoc<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">XContentType</span><span class="token punctuation">.</span><span class="token constant">JSON</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3.发送请求</span>
        <span class="token class-name">IndexResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;res=&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">testGetDocumentById</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1.准备Request对象</span>
        <span class="token class-name">GetRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GetRequest</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.发送请求</span>
        <span class="token class-name">GetResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3.获取响应结果中的source</span>
        <span class="token class-name">String</span> json <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">UserDoc</span> userDoc <span class="token operator">=</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toBean</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> <span class="token class-name">UserDoc</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;userDoc= &quot;</span> <span class="token operator">+</span> userDoc<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">testDeleteDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1.准备Request，两个参数，第一个是索引库名，第二个是文档id</span>
        <span class="token class-name">DeleteRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeleteRequest</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.发送请求</span>
        client<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">testUpdateDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1.准备Request</span>
        <span class="token class-name">UpdateRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UpdateRequest</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.准备请求参数</span>
        request<span class="token punctuation">.</span><span class="token function">doc</span><span class="token punctuation">(</span>
                <span class="token string">&quot;user_name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;王五&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;gender&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3.发送请求</span>
        <span class="token class-name">UpdateResponse</span> updateResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;updateResponse.getResult() = &quot;</span> <span class="token operator">+</span> updateResponse<span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">testBulk</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserDoc</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">UserDoc</span> userDoc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserDoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            userDoc<span class="token punctuation">.</span><span class="token function">setUserName</span><span class="token punctuation">(</span><span class="token string">&quot;zhangsan_&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            userDoc<span class="token punctuation">.</span><span class="token function">setGender</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>userDoc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 1.创建Request</span>
        <span class="token class-name">BulkRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BulkRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2.准备请求参数</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">UserDoc</span> userDoc <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IndexRequest</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toJsonStr</span><span class="token punctuation">(</span>userDoc<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">XContentType</span><span class="token punctuation">.</span><span class="token constant">JSON</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 3.发送请求</span>
        <span class="token class-name">BulkResponse</span> bulkResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">bulk</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;bulkResponse.getTook() = &quot;</span> <span class="token operator">+</span> bulkResponse<span class="token punctuation">.</span><span class="token function">getTook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>bulkResponse<span class="token punctuation">.</span><span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@AfterEach</span>
    <span class="token keyword">void</span> <span class="token function">tearDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;tearDown success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br></div></div><h2 id="学习参考"><a href="#学习参考" class="header-anchor">#</a> 学习参考</h2> <ul><li>视频地址：<a href="https://www.bilibili.com/video/BV1hh411D7sb/?vd_source=d130139a92227a66fb558961b98507cb" target="_blank" rel="noopener noreferrer">【尚硅谷】ElasticSearch教程入门到精通（基于ELK技术栈elasticsearch 7.x+8.x新特性）_bilibili<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>笔记地址：<a href="https://blog.csdn.net/u011863024/article/details/115721328" target="_blank" rel="noopener noreferrer">Elasticsearch学习笔记-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://mp.weixin.qq.com/s/GG_zrQlaiP2nfPOxzx_j9w" target="_blank" rel="noopener noreferrer">Elasticsearch 基础入门详文<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://mp.weixin.qq.com/s/gOhaYM9IwC_l_Lt54DCCKw" target="_blank" rel="noopener noreferrer">Elasticsearch 保姆级入门篇<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.zhihu.com/question/469207536/answer/2550197723" target="_blank" rel="noopener noreferrer">ElasticSearch在项目中具体怎么用？ - 知乎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://t.zsxq.com/4K41D" target="_blank" rel="noopener noreferrer">https://t.zsxq.com/4K41D<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/4/28 17:48:47</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/55a651/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">讲讲断点续传的实现</div></a> <a href="/pages/ec50b4/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Elasticsearch之DSL篇</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/55a651/" class="prev">讲讲断点续传的实现</a></span> <span class="next"><a href="/pages/ec50b4/">Elasticsearch之DSL篇</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:2691357857@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/cmty256" title="Github" target="_blank" class="iconfont icon-github"></a><a href="https://blog.csdn.net/qq_54088234?spm=1011.2124.3001.5343" title="CSDN" target="_blank" class="iconfont icon-csdn"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2025
    <span>沉梦听雨 | <a href="https://gitee.com/dream-deeply-tyu" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><canvas id="vuepress-canvas-cursor"></canvas><!----><div></div></div></div>
    <script src="/assets/js/app.cded0381.js" defer></script><script src="/assets/js/2.02bc9df6.js" defer></script><script src="/assets/js/189.409deb85.js" defer></script><script src="/assets/js/6.9155b086.js" defer></script>
  </body>
</html>
