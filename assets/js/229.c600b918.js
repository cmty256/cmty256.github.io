(window.webpackJsonp=window.webpackJsonp||[]).push([[229],{562:function(s,a,t){"use strict";t.r(a);var e=t(1),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"git-修改已提交人的用户名和邮箱"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#git-修改已提交人的用户名和邮箱"}},[s._v("#")]),s._v(" git 修改已提交人的用户名和邮箱")]),s._v(" "),a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),a("p",[a("strong",[s._v("需注意以下两点内容：")])]),s._v(" "),a("ol",[a("li",[s._v("需要在顶层目录下(就是 "),a("code",[s._v(".git")]),s._v(' 文件夹所在的目录下，右键打开 "Git Bash Here"），否则运行下面的代码时会报错；')]),s._v(" "),a("li",[s._v("确保要修改的仓库，里面的文件和远程仓库的版本一致，"),a("strong",[s._v("如果有修改还未提交的内容，需要先提交或者取消更改")]),s._v("，否则运行下面的代码时会报错。")])]),s._v(" "),a("h2",{attrs:{id:"场景一-修改最后一次提交的提交人信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#场景一-修改最后一次提交的提交人信息"}},[s._v("#")]),s._v(" 场景一：修改最后一次提交的提交人信息")]),s._v(" "),a("p",[s._v("执行指令：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("--author")]),s._v("：指定新的提交人信息，格式为"),a("code",[s._v("用户名 <邮箱>")]),s._v("。")]),s._v(" "),a("li",[a("code",[s._v("--no-edit")]),s._v("：不修改提交说明，仅更新提交人；若需同时修改提交信息，可去掉该参数，在编辑器中编辑后保存。")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 直接修改并覆盖最后一次提交")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--amend")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--author")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"新用户名 <新邮箱地址>"')]),s._v(" --no-edit\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("强制推送到远程（若已推送）：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("--force-with-lease")]),s._v("：比直接 "),a("code",[s._v("--force")]),s._v(" 更安全，会检查远程分支是否有他人的新提交，避免覆盖他人工作。")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果最后一次提交已经推送到远程，需要强制推送覆盖")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push --force-with-lease origin 分支名\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"场景二-修改所有历史提交的提交人信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#场景二-修改所有历史提交的提交人信息"}},[s._v("#")]),s._v(" 场景二：修改所有历史提交的提交人信息")]),s._v(" "),a("p",[s._v("如果需要修改"),a("strong",[s._v("仓库所有历史提交")]),s._v("的提交人信息（如用户名 / 邮箱填写错误，需全局修正），推荐使用 Git 官方提供的"),a("strong",[s._v("脚本批量修改")]),s._v("。")]),s._v(" "),a("h3",{attrs:{id:"_1-备份仓库-可选但推荐"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-备份仓库-可选但推荐"}},[s._v("#")]),s._v(" 1. 备份仓库（可选但推荐）")]),s._v(" "),a("p",[s._v("为防止操作失误，先复制一份仓库目录作为备份。")]),s._v(" "),a("h3",{attrs:{id:"_2-执行批量修改脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-执行批量修改脚本"}},[s._v("#")]),s._v(" 2. 执行批量修改脚本")]),s._v(" "),a("p",[s._v("在仓库根目录执行以下脚本（替换其中的"),a("code",[s._v("<旧邮箱>")]),s._v("、"),a("code",[s._v("<新用户名>")]),s._v("、"),a("code",[s._v("<新邮箱>")]),s._v("为实际值）：")]),s._v(" "),a("p",[a("strong",[s._v("主要修改以下三点内容：")])]),s._v(" "),a("ul",[a("li",[a("code",[s._v("OLD_EMAIL")]),s._v("：填修改前的邮箱地址")]),s._v(" "),a("li",[a("code",[s._v("CORRECT_NAME")]),s._v("：填新的用户名称")]),s._v(" "),a("li",[a("code",[s._v("CORRECT_EMAIL")]),s._v("：填新的邮箱")])]),s._v(" "),a("p",[s._v('然后在 "'),a("strong",[s._v("Git Bash Here")]),s._v('" 打开的窗口里面运行代码：')]),s._v(" "),a("ul",[a("li",[a("code",[s._v("--env-filter")]),s._v("：通过环境变量修改提交的作者（Author）和提交者（Committer）信息。")]),s._v(" "),a("li",[a("code",[s._v("--tag-name-filter cat")]),s._v("：保留标签信息，不修改标签。")]),s._v(" "),a("li",[a("code",[s._v("--branches --tags")]),s._v("：对所有分支和标签的提交生效。")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" filter-branch --env-filter "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'\n\nOLD_EMAIL="xxxx@qq.com"\nCORRECT_NAME="chenmeng"\nCORRECT_EMAIL="xxxx@qq.com"\n\nif [ "$GIT_COMMITTER_EMAIL" = "$OLD_EMAIL" ]\nthen\nexport GIT_COMMITTER_NAME="$CORRECT_NAME"\nexport GIT_COMMITTER_EMAIL="$CORRECT_EMAIL"\nfi\nif [ "$GIT_AUTHOR_EMAIL" = "$OLD_EMAIL" ]\nthen\nexport GIT_AUTHOR_NAME="$CORRECT_NAME"\nexport GIT_AUTHOR_EMAIL="$CORRECT_EMAIL"\nfi\n\'')]),s._v(" --tag-name-filter "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" -- "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--branches")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tags")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h3",{attrs:{id:"_3-清理临时文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-清理临时文件"}},[s._v("#")]),s._v(" 3. 清理临时文件")]),s._v(" "),a("p",[s._v("脚本执行后会生成临时文件，执行以下命令清理：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" update-ref "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" refs/original/refs/heads/分支名\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" reflog expire "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--expire")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("now "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--all")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" gc "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--prune")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("now\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"强制推送到远程分支-若已推送"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#强制推送到远程分支-若已推送"}},[s._v("#")]),s._v(" 强制推送到远程分支（若已推送）")]),s._v(" "),a("p",[s._v("执行完第一步的命令之后，执行下面这条命令，强制推送到远程仓库：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 强制推送本地分支到远程仓库，直接覆盖远程分支的历史记录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 风险：无论远程分支是否有他人的新提交，都会强制覆盖，可能导致他人的提交丢失")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 适用场景：本地仓库是唯一提交源，或确认远程分支无他人更新的私人仓库")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--force")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --force-with-lease：安全的强制推送，先检查远程分支是否有本地未同步的新提交，若有则拒绝推送")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# origin：指定推送的远程仓库名称（默认远程仓库名）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --all：推送本地所有分支到远程仓库，覆盖所有对应的远程分支")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 风险：仅在确认所有本地分支的修改是最新且需要覆盖远程时使用，团队协作前需通知协作者")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push --force-with-lease origin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--all")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定推送到 dev 分支")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push --force-with-lease origin dev\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --force-with-lease：安全强制推送，先校验远程标签是否有本地未同步的更新")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# origin：指定远程仓库名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --tags：推送本地所有标签（tag）到远程仓库，并覆盖远程对应的同名标签")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 适用场景：修改了历史提交后，需要同步本地更新后的标签到远程")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意：标签一旦推送，修改后强制推送会导致远程标签历史丢失，需谨慎")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push --force-with-lease origin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tags")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("h2",{attrs:{id:"学习参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#学习参考"}},[s._v("#")]),s._v(" 学习参考")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.csdn.net/u014641168/article/details/125414820?ops_request_misc=&request_id=&biz_id=102&utm_term=gitee%E4%BF%AE%E6%94%B9%E5%B7%B2%E6%8F%90%E4%BA%A4%E7%9A%84%E6%8F%90%E4%BA%A4%E4%BA%BA%E9%82%AE%E7%AE%B1&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-3-125414820.142%5Ev96%5Epc_search_result_base1&spm=1018.2226.3001.4187",target:"_blank",rel:"noopener noreferrer"}},[s._v("Git 修改已提交的用户名和邮箱_git修改提交者用户名和邮箱-CSDN博客"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports}}]);