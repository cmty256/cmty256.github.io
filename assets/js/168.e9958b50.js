(window.webpackJsonp=window.webpackJsonp||[]).push([[168],{497:function(t,r,e){"use strict";e.r(r);var _=e(1),s=Object(_.a)({},(function(){var t=this,r=t._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"基于-redis-实现消息队列"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#基于-redis-实现消息队列"}},[t._v("#")]),t._v(" 基于 Redis 实现消息队列")]),t._v(" "),r("h2",{attrs:{id:"使用特性"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#使用特性"}},[t._v("#")]),t._v(" 使用特性")]),t._v(" "),r("p",[t._v("基于 Redis 实现分布式消息队列：")]),t._v(" "),r("ul",[r("li",[t._v("使用 "),r("a",{attrs:{href:"http://www.redis.cn/topics/streams-intro.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Stream"),r("OutboundLink")],1),t._v(" 特性，提供【集群】消费的能力。")]),t._v(" "),r("li",[t._v("使用 "),r("a",{attrs:{href:"http://www.redis.cn/topics/pubsub.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Pub/Sub"),r("OutboundLink")],1),t._v(" 特性，提供【广播】消费的能力。")])]),t._v(" "),r("h2",{attrs:{id:"_1、集群消费"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1、集群消费"}},[t._v("#")]),t._v(" 1、集群消费")]),t._v(" "),r("p",[t._v("集群消费，是指消息发送到 Redis 时，"),r("strong",[t._v("有且只会")]),t._v("被一个消费者（应用 JVM 实例）收到，然后消费成功。")]),t._v(" "),r("blockquote",[r("p",[t._v("如果你需要使用到【集群】消费，必须使用 "),r("strong",[t._v("Redis 5.0.0 以上版本")]),t._v("，因为 "),r("strong",[t._v("Stream 特性")]),t._v("是在该版本之后才引入的。")])]),t._v(" "),r("h3",{attrs:{id:"使用场景"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#使用场景"}},[t._v("#")]),t._v(" 使用场景")]),t._v(" "),r("p",[t._v("集群消费在项目中的使用场景，主要是提供可靠的、可堆积的异步任务的能力。例如说：")]),t._v(" "),r("ol",[r("li",[t._v("短信模块，使用它"),r("strong",[t._v("异步")]),t._v("发送短信。")]),t._v(" "),r("li",[t._v("邮件模块，使用它"),r("strong",[t._v("异步")]),t._v("发送邮件。")])]),t._v(" "),r("p",[t._v("相比来说，")]),t._v(" "),r("ul",[r("li",[r("code",[t._v("Spring Async")]),t._v(" 在 JVM 实例重启时，"),r("strong",[t._v("会导致未执行完的任务丢失")]),t._v("。")]),t._v(" "),r("li",[t._v("而集群消费，因为消息是存储在 "),r("code",[t._v("Redis")]),t._v(" 中，所以"),r("strong",[t._v("不会存在该问题")]),t._v("。")])]),t._v(" "),r("h2",{attrs:{id:"_2、广播消费"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2、广播消费"}},[t._v("#")]),t._v(" 2、广播消费")]),t._v(" "),r("p",[t._v("广播消费，是指消息发送到 Redis 时，"),r("strong",[t._v("所有")]),t._v("消费者（应用 JVM 实例）收到，然后消费成功。")]),t._v(" "),r("h3",{attrs:{id:"使用场景-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#使用场景-2"}},[t._v("#")]),t._v(" 使用场景")]),t._v(" "),r("ol",[r("li",[t._v("例如说，在应用中，缓存了数据字典等配置表在内存中，可以通过 Redis 广播消费，实现每个应用节点都消费消息，"),r("strong",[t._v("刷新本地内存的缓存")]),t._v("。")]),t._v(" "),r("li",[t._v("又例如说，我们基于 WebSocket 实现了 "),r("strong",[t._v("IM 聊天")]),t._v("，在我们给用户主动发送消息时，因为我们不知道用户连接的是哪个提供 WebSocket 的应用，所以可以通过 Redis 广播消费。每个应用判断当前用户是否是和自己提供的 WebSocket 服务连接，如果是，则推送消息给用户。")])]),t._v(" "),r("h2",{attrs:{id:"学习参考"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#学习参考"}},[t._v("#")]),t._v(" 学习参考")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"http://1.119.164.247:8090/message-queue/redis/",target:"_blank",rel:"noopener noreferrer"}},[t._v("消息队列（Redis） | ruoyi-vue-pro 开发指南"),r("OutboundLink")],1)])])])}),[],!1,null,null,null);r.default=s.exports}}]);