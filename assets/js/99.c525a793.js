(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{432:function(_,t,v){"use strict";v.r(t);var r=v(1),s=Object(r.a)({},(function(){var _=this,t=_._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("h1",{attrs:{id:"聊聊分库分表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#聊聊分库分表"}},[_._v("#")]),_._v(" 聊聊分库分表")]),_._v(" "),t("h2",{attrs:{id:"如何分库或分表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如何分库或分表"}},[_._v("#")]),_._v(" 如何分库或分表？")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("类型")]),_._v(" "),t("th",[_._v("拆的是什么")]),_._v(" "),t("th",[_._v("拆的方式")]),_._v(" "),t("th",[_._v("举例")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("✅ "),t("strong",[_._v("垂直分库")])]),_._v(" "),t("td",[_._v("按“业务模块”拆库")]),_._v(" "),t("td",[_._v("不同模块放不同库")]),_._v(" "),t("td",[_._v("用户库、订单库、日志库")])]),_._v(" "),t("tr",[t("td",[_._v("✅ "),t("strong",[_._v("水平分库")])]),_._v(" "),t("td",[_._v("按“数据量”拆库")]),_._v(" "),t("td",[_._v("相同结构，分布到多个库")]),_._v(" "),t("td",[_._v("用户数据分到 "),t("code",[_._v("user_db_0")]),_._v(", "),t("code",[_._v("user_db_1")])])]),_._v(" "),t("tr",[t("td",[_._v("✅ "),t("strong",[_._v("垂直分表")])]),_._v(" "),t("td",[_._v("按“表结构”拆表")]),_._v(" "),t("td",[_._v("一张大表拆成多个小表")]),_._v(" "),t("td",[_._v("用户表拆成："),t("code",[_._v("user_base")]),_._v(" + "),t("code",[_._v("user_login")])])]),_._v(" "),t("tr",[t("td",[_._v("✅ "),t("strong",[_._v("水平分表")])]),_._v(" "),t("td",[_._v("按“数据量”拆表")]),_._v(" "),t("td",[_._v("同结构，数据按规则分布")]),_._v(" "),t("td",[t("code",[_._v("order_0")]),_._v(", "),t("code",[_._v("order_1")]),_._v(", ..., "),t("code",[_._v("order_15")])])])])]),_._v(" "),t("h2",{attrs:{id:"图解理解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#图解理解"}},[_._v("#")]),_._v(" 图解理解")]),_._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v("垂直分库：                     水平分库：\n\n[原始DB]                      [原始DB]\n ├─ user                     ├─ user (1亿)\n ├─ order                   => 拆成\n ├─ product                  ├─ user_0 (0~5000万)\n ↓                           └─ user_1 (5000万~1亿)\n\n拆成：\n[user_db] → user             [user_db_0] → user\n[order_db] → order           [user_db_1] → user\n垂直分表：                  水平分表：\n\n[User]                      [Order] (10亿)\n ├─ id                     =>\n ├─ name                    ├─ order_0\n ├─ email                   ├─ order_1\n ├─ password                ...\n ↓\n拆成：\n[user_base] → id, name, email\n[user_login] → user_id, password\n")])]),_._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[_._v("1")]),t("br"),t("span",{staticClass:"line-number"},[_._v("2")]),t("br"),t("span",{staticClass:"line-number"},[_._v("3")]),t("br"),t("span",{staticClass:"line-number"},[_._v("4")]),t("br"),t("span",{staticClass:"line-number"},[_._v("5")]),t("br"),t("span",{staticClass:"line-number"},[_._v("6")]),t("br"),t("span",{staticClass:"line-number"},[_._v("7")]),t("br"),t("span",{staticClass:"line-number"},[_._v("8")]),t("br"),t("span",{staticClass:"line-number"},[_._v("9")]),t("br"),t("span",{staticClass:"line-number"},[_._v("10")]),t("br"),t("span",{staticClass:"line-number"},[_._v("11")]),t("br"),t("span",{staticClass:"line-number"},[_._v("12")]),t("br"),t("span",{staticClass:"line-number"},[_._v("13")]),t("br"),t("span",{staticClass:"line-number"},[_._v("14")]),t("br"),t("span",{staticClass:"line-number"},[_._v("15")]),t("br"),t("span",{staticClass:"line-number"},[_._v("16")]),t("br"),t("span",{staticClass:"line-number"},[_._v("17")]),t("br"),t("span",{staticClass:"line-number"},[_._v("18")]),t("br"),t("span",{staticClass:"line-number"},[_._v("19")]),t("br"),t("span",{staticClass:"line-number"},[_._v("20")]),t("br"),t("span",{staticClass:"line-number"},[_._v("21")]),t("br"),t("span",{staticClass:"line-number"},[_._v("22")]),t("br")])]),t("h2",{attrs:{id:"每种方式的目的和适用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#每种方式的目的和适用场景"}},[_._v("#")]),_._v(" 每种方式的目的和适用场景")]),_._v(" "),t("h3",{attrs:{id:"_1-垂直分库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-垂直分库"}},[_._v("#")]),_._v(" 1. 垂直分库")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("场景")]),_._v(" "),t("th",[_._v("内容")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("拆分维度")]),_._v(" "),t("td",[_._v("业务模块或功能模块")])]),_._v(" "),t("tr",[t("td",[_._v("目的")]),_._v(" "),t("td",[_._v("解耦、减轻数据库压力、方便运维")])]),_._v(" "),t("tr",[t("td",[_._v("举例")]),_._v(" "),t("td",[_._v("用户模块放 "),t("code",[_._v("user_db")]),_._v("，订单模块放 "),t("code",[_._v("order_db")]),_._v("，日志模块放 "),t("code",[_._v("log_db")])])])])]),_._v(" "),t("p",[_._v("👉 "),t("strong",[_._v("适合中台系统、模块化微服务架构")]),_._v("，让各模块独立开发、部署、扩展。")]),_._v(" "),t("h3",{attrs:{id:"_2-水平分库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-水平分库"}},[_._v("#")]),_._v(" 2. 水平分库")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("场景")]),_._v(" "),t("th",[_._v("数据量非常大，单库压力大")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("拆分维度")]),_._v(" "),t("td",[_._v("相同结构的表，按规则拆到多个库中")])]),_._v(" "),t("tr",[t("td",[_._v("举例")]),_._v(" "),t("td",[t("code",[_._v("user")]),_._v(" 表有 2 亿数据 → 分到 4 个库，每库 5000 万")])])])]),_._v(" "),t("p",[_._v("👉 通常结合"),t("strong",[_._v("分表一起使用")]),_._v("（水平分库 + 水平分表）。")]),_._v(" "),t("h3",{attrs:{id:"_3-垂直分表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-垂直分表"}},[_._v("#")]),_._v(" 3. 垂直分表")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("场景")]),_._v(" "),t("th",[_._v("表字段太多、部分字段访问频率极低")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("拆分方式")]),_._v(" "),t("td",[_._v("把冷字段拆出去，按字段功能分类")])]),_._v(" "),t("tr",[t("td",[_._v("举例")]),_._v(" "),t("td",[_._v("用户表拆成 "),t("code",[_._v("user_profile")]),_._v("、"),t("code",[_._v("user_login")]),_._v("、"),t("code",[_._v("user_settings")]),_._v(" 表")])])])]),_._v(" "),t("p",[_._v("👉 适用于做"),t("strong",[_._v("冷热分离、读写优化、字段稀疏的场景")]),_._v("。")]),_._v(" "),t("h3",{attrs:{id:"_4-水平分表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-水平分表"}},[_._v("#")]),_._v(" 4. 水平分表")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("场景")]),_._v(" "),t("th",[_._v("单表数据量太大（>千万），查询慢")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("拆分方式")]),_._v(" "),t("td",[_._v("按 ID、时间、用户ID 等维度将一张大表拆为多个小表")])]),_._v(" "),t("tr",[t("td",[_._v("举例")]),_._v(" "),t("td",[t("code",[_._v("order")]),_._v(" 表按月份分成 "),t("code",[_._v("order_202401")]),_._v(" ~ "),t("code",[_._v("order_202412")])])])])]),_._v(" "),t("p",[_._v("👉 最常见的拆分方式，适用于"),t("strong",[_._v("订单、日志、告警、交易流水等海量数据表")]),_._v("。")]),_._v(" "),t("h2",{attrs:{id:"总结对比表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#总结对比表"}},[_._v("#")]),_._v(" 总结对比表")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("类型")]),_._v(" "),t("th",[_._v("拆分维度")]),_._v(" "),t("th",[_._v("目标")]),_._v(" "),t("th",[_._v("难度")]),_._v(" "),t("th",[_._v("常见场景")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("垂直分库")]),_._v(" "),t("td",[_._v("按模块")]),_._v(" "),t("td",[_._v("解耦+并发")]),_._v(" "),t("td",[_._v("中等")]),_._v(" "),t("td",[_._v("用户、订单分库")])]),_._v(" "),t("tr",[t("td",[_._v("水平分库")]),_._v(" "),t("td",[_._v("按数据")]),_._v(" "),t("td",[_._v("扩展性")]),_._v(" "),t("td",[_._v("高")]),_._v(" "),t("td",[_._v("超大用户/订单表")])]),_._v(" "),t("tr",[t("td",[_._v("垂直分表")]),_._v(" "),t("td",[_._v("按字段")]),_._v(" "),t("td",[_._v("热冷分离")]),_._v(" "),t("td",[_._v("低")]),_._v(" "),t("td",[_._v("用户信息表")])]),_._v(" "),t("tr",[t("td",[_._v("水平分表")]),_._v(" "),t("td",[_._v("按数据")]),_._v(" "),t("td",[_._v("降低单表压力")]),_._v(" "),t("td",[_._v("中等")]),_._v(" "),t("td",[_._v("日志、订单、记录表")])])])]),_._v(" "),t("h2",{attrs:{id:"最佳实践建议"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践建议"}},[_._v("#")]),_._v(" 最佳实践建议")]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("优先做垂直分库")]),_._v("：随着业务模块增加，自然会拆出多个模块库。")]),_._v(" "),t("li",[t("strong",[_._v("热点大表做水平分表")]),_._v("：例如订单、日志等，千万级时开始规划。")]),_._v(" "),t("li",[t("strong",[_._v("使用 ShardingSphere 等中间件")]),_._v("：简化路由、分库分表维护。")]),_._v(" "),t("li",[t("strong",[_._v("统一 ID 生成器")]),_._v("：所有分库分表都需要全局唯一 ID（如雪花算法）。")])]),_._v(" "),t("h2",{attrs:{id:"学习参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#学习参考"}},[_._v("#")]),_._v(" 学习参考")]),_._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://javaguide.cn/high-performance/read-and-write-separation-and-library-subtable.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("读写分离和分库分表详解 | JavaGuide"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=s.exports}}]);